
MUSHROOM CLASSIFICATION CNN - 5- CLASSES + RESIDUAL CONNECTIONS (TensorFlow 2.19.1 & Keras 3.x EXKLUSIV)
==========================================================================================

MUSHROOM CLASSIFICATION CNN - RESNET50 TRANSFER LEARNING (TensorFlow 2.19.1 & Keras 3.x EXKLUSIV)
====================================================================================================
Classes: Amanita_muscaria, Boletus_edulis, Armillaria_mellea, Phallus_impudicus, Cantharellus_cibarius
Architecture: ECHTES ResNet50 (ImageNet Pretrained) + Transfer Learning
Improvements: Fine-Tuning der letzten Layer, Dense-Top, Dropout, Adam Optimizer
Data: 80/20 split from data/randomized_mushrooms/inaturalist
Training: Randomized 200x200 images (80%)
Testing: Randomized 200x200 images (20%)
Output: Modern .keras format (with .h5 fallback for compatibility)
KERAS 3.x ERFORDERLICH - Keine Fallbacks!
====================================================================================================

Baue Transfer-Learning Modell mit ResNet50 (ImageNet)...
ResNet50-Transfermodell erstellt und kompiliert!

Starting training process with 80/20 split from randomized data...

Lade randomisierte Pilzdaten f체r 80/20 Train/Test Split...
Lade Daten aus: C:\Users\strau\OneDrive\Documents\Git\sml_main\SmallLanguageModels\data\randomized_mushrooms\inaturalist
Konfigurierte Klassen: ['Phallus_impudicus', 'Amanita_muscaria', 'Boletus_edulis', 'Cantharellus_cibarius', 'Armillaria_mellea']
Anzahl Klassen: 5

1. Sammle alle Bilder aus allen Klassen...
   Phallus_impudicus: 1500 Dateien gefunden
   Amanita_muscaria: 1500 Dateien gefunden
   Boletus_edulis: 1500 Dateien gefunden
   Cantharellus_cibarius: 1500 Dateien gefunden
   Armillaria_mellea: 1500 Dateien gefunden

   Gesamt gesammelt: 7500 Dateien

2. Erstelle 80/20 Train/Test Split...
   Training: 6000 Dateien (80.0%)
   Test: 1500 Dateien (20.0%)

   Klassenverteilung im Training:
     Phallus_impudicus: 1200 Bilder
     Amanita_muscaria: 1200 Bilder
     Boletus_edulis: 1200 Bilder
     Cantharellus_cibarius: 1200 Bilder
     Armillaria_mellea: 1200 Bilder

   Klassenverteilung im Test:
     Phallus_impudicus: 300 Bilder
     Amanita_muscaria: 300 Bilder
     Boletus_edulis: 300 Bilder
     Cantharellus_cibarius: 300 Bilder
     Armillaria_mellea: 300 Bilder

3. Lade Bilddaten...
Loading training images:   0%|                                                                   | 0/6000 [00:00<?, ?it/s]Loading training images:   1%|3                                                        | 33/6000 [00:00<00:18, 328.54it/s]Loading training images:   1%|6                                                        | 68/6000 [00:00<00:18, 318.50it/s]Loading training images:   2%|9                                                       | 100/6000 [00:00<00:18, 318.00it/s]Loading training images:   2%|#2                                                      | 132/6000 [00:00<00:18, 310.84it/s]Loading training images:   3%|#5                                                      | 165/6000 [00:00<00:18, 317.15it/s]Loading training images:   3%|#8                                                      | 197/6000 [00:00<00:18, 317.88it/s]Loading training images:   4%|##1                                                     | 229/6000 [00:00<00:18, 308.60it/s]Loading training images:   4%|##4                                                     | 260/6000 [00:00<00:18, 308.72it/s]Loading training images:   5%|##7                                                     | 293/6000 [00:00<00:18, 300.38it/s]Loading training images:   5%|###                                                     | 325/6000 [00:01<00:18, 305.71it/s]Loading training images:   6%|###3                                                    | 356/6000 [00:01<00:18, 306.07it/s]Loading training images:   6%|###6                                                    | 387/6000 [00:01<00:18, 306.59it/s]Loading training images:   7%|###9                                                    | 423/6000 [00:01<00:18, 308.42it/s]Loading training images:   8%|####2                                                   | 459/6000 [00:01<00:17, 308.47it/s]Loading training images:   8%|####5                                                   | 490/6000 [00:01<00:17, 308.86it/s]Loading training images:   9%|####8                                                   | 521/6000 [00:01<00:18, 294.08it/s]Loading training images:   9%|#####1                                                  | 556/6000 [00:01<00:18, 297.53it/s]Loading training images:  10%|#####4                                                  | 587/6000 [00:01<00:17, 300.75it/s]Loading training images:  10%|#####7                                                  | 618/6000 [00:02<00:18, 298.76it/s]Loading training images:  11%|######                                                  | 648/6000 [00:02<00:18, 294.35it/s]Loading training images:  11%|######3                                                 | 681/6000 [00:02<00:17, 302.26it/s]Loading training images:  12%|######6                                                 | 712/6000 [00:02<00:17, 295.24it/s]Loading training images:  12%|######9                                                 | 743/6000 [00:02<00:17, 299.28it/s]Loading training images:  13%|#######2                                                | 779/6000 [00:02<00:16, 308.62it/s]Loading training images:  14%|#######5                                                | 814/6000 [00:02<00:16, 312.67it/s]Loading training images:  14%|#######8                                                | 846/6000 [00:02<00:16, 308.49it/s]Loading training images:  15%|########1                                               | 877/6000 [00:02<00:16, 307.92it/s]Loading training images:  15%|########4                                               | 908/6000 [00:02<00:16, 307.98it/s]Loading training images:  16%|########7                                               | 939/6000 [00:03<00:16, 305.74it/s]Loading training images:  16%|#########                                               | 971/6000 [00:03<00:16, 299.14it/s]Loading training images:  17%|#########1                                             | 1001/6000 [00:03<00:18, 273.38it/s]Loading training images:  17%|#########4                                             | 1035/6000 [00:03<00:17, 290.17it/s]Loading training images:  18%|#########8                                             | 1072/6000 [00:03<00:16, 304.45it/s]Loading training images:  18%|##########1                                            | 1110/6000 [00:03<00:15, 312.01it/s]Loading training images:  19%|##########4                                            | 1143/6000 [00:03<00:15, 316.88it/s]Loading training images:  20%|##########8                                            | 1179/6000 [00:03<00:15, 321.08it/s]Loading training images:  20%|###########1                                           | 1217/6000 [00:03<00:14, 323.58it/s]Loading training images:  21%|###########4                                           | 1250/6000 [00:04<00:16, 294.89it/s]Loading training images:  21%|###########7                                           | 1282/6000 [00:04<00:16, 290.74it/s]Loading training images:  22%|############                                           | 1315/6000 [00:04<00:15, 299.63it/s]Loading training images:  23%|############4                                          | 1353/6000 [00:04<00:14, 313.87it/s]Loading training images:  23%|############7                                          | 1390/6000 [00:04<00:14, 315.80it/s]Loading training images:  24%|#############                                          | 1423/6000 [00:04<00:14, 319.51it/s]Loading training images:  24%|#############3                                         | 1456/6000 [00:04<00:14, 322.26it/s]Loading training images:  25%|#############6                                         | 1489/6000 [00:04<00:14, 319.09it/s]Loading training images:  25%|#############9                                         | 1521/6000 [00:04<00:14, 305.78it/s]Loading training images:  26%|##############2                                        | 1552/6000 [00:05<00:14, 301.07it/s]Loading training images:  26%|##############5                                        | 1588/6000 [00:05<00:14, 308.46it/s]Loading training images:  27%|##############8                                        | 1620/6000 [00:05<00:14, 311.55it/s]Loading training images:  28%|###############1                                       | 1652/6000 [00:05<00:13, 310.82it/s]Loading training images:  28%|###############4                                       | 1684/6000 [00:05<00:14, 299.12it/s]Loading training images:  29%|###############7                                       | 1715/6000 [00:05<00:14, 288.52it/s]Loading training images:  29%|###############9                                       | 1745/6000 [00:05<00:14, 291.42it/s]Loading training images:  30%|################2                                      | 1775/6000 [00:05<00:14, 287.58it/s]Loading training images:  30%|################5                                      | 1806/6000 [00:05<00:14, 293.68it/s]Loading training images:  31%|################8                                      | 1837/6000 [00:06<00:13, 298.21it/s]Loading training images:  31%|#################1                                     | 1867/6000 [00:06<00:13, 298.18it/s]Loading training images:  32%|#################4                                     | 1899/6000 [00:06<00:13, 304.49it/s]Loading training images:  32%|#################6                                     | 1930/6000 [00:06<00:13, 302.85it/s]Loading training images:  33%|#################9                                     | 1961/6000 [00:06<00:13, 297.95it/s]Loading training images:  33%|##################2                                    | 1996/6000 [00:06<00:13, 302.37it/s]Loading training images:  34%|##################5                                    | 2029/6000 [00:06<00:13, 296.01it/s]Loading training images:  34%|##################8                                    | 2059/6000 [00:06<00:13, 294.59it/s]Loading training images:  35%|###################1                                   | 2089/6000 [00:06<00:13, 292.64it/s]Loading training images:  35%|###################4                                   | 2119/6000 [00:06<00:13, 286.80it/s]Loading training images:  36%|###################6                                   | 2148/6000 [00:07<00:13, 287.23it/s]Loading training images:  36%|###################9                                   | 2177/6000 [00:07<00:13, 277.16it/s]Loading training images:  37%|####################2                                  | 2207/6000 [00:07<00:13, 281.68it/s]Loading training images:  37%|####################5                                  | 2240/6000 [00:07<00:12, 294.17it/s]Loading training images:  38%|####################8                                  | 2270/6000 [00:07<00:12, 295.50it/s]Loading training images:  38%|#####################1                                 | 2303/6000 [00:07<00:12, 293.92it/s]Loading training images:  39%|#####################3                                 | 2333/6000 [00:07<00:12, 295.03it/s]Loading training images:  39%|#####################6                                 | 2363/6000 [00:07<00:12, 285.49it/s]Loading training images:  40%|#####################9                                 | 2394/6000 [00:07<00:12, 286.11it/s]Loading training images:  40%|######################2                                | 2423/6000 [00:08<00:12, 278.83it/s]Loading training images:  41%|######################5                                | 2455/6000 [00:08<00:12, 288.76it/s]Loading training images:  41%|######################7                                | 2484/6000 [00:08<00:12, 275.61it/s]Loading training images:  42%|#######################                                | 2512/6000 [00:08<00:13, 265.51it/s]Loading training images:  42%|#######################2                               | 2539/6000 [00:08<00:14, 243.44it/s]Loading training images:  43%|#######################5                               | 2566/6000 [00:08<00:13, 250.13it/s]Loading training images:  43%|#######################7                               | 2594/6000 [00:08<00:13, 258.17it/s]Loading training images:  44%|########################                               | 2625/6000 [00:08<00:12, 272.40it/s]Loading training images:  44%|########################3                              | 2658/6000 [00:08<00:11, 285.76it/s]Loading training images:  45%|########################6                              | 2693/6000 [00:09<00:11, 296.14it/s]Loading training images:  45%|########################9                              | 2724/6000 [00:09<00:10, 298.47it/s]Loading training images:  46%|#########################2                             | 2757/6000 [00:09<00:10, 296.03it/s]Loading training images:  46%|#########################5                             | 2789/6000 [00:09<00:10, 295.61it/s]Loading training images:  47%|#########################8                             | 2822/6000 [00:09<00:10, 295.47it/s]Loading training images:  48%|##########################1                            | 2852/6000 [00:09<00:11, 278.16it/s]Loading training images:  48%|##########################4                            | 2880/6000 [00:09<00:11, 275.99it/s]Loading training images:  48%|##########################6                            | 2910/6000 [00:09<00:11, 277.79it/s]Loading training images:  49%|##########################9                            | 2939/6000 [00:09<00:10, 279.97it/s]Loading training images:  49%|###########################2                           | 2968/6000 [00:10<00:10, 282.47it/s]Loading training images:  50%|###########################5                           | 3001/6000 [00:10<00:10, 282.50it/s]Loading training images:  51%|###########################7                           | 3031/6000 [00:10<00:10, 276.94it/s]Loading training images:  51%|############################                           | 3060/6000 [00:10<00:10, 280.14it/s]Loading training images:  52%|############################3                          | 3090/6000 [00:10<00:10, 284.83it/s]Loading training images:  52%|############################6                          | 3124/6000 [00:10<00:09, 288.62it/s]Loading training images:  53%|############################9                          | 3156/6000 [00:10<00:09, 296.79it/s]Loading training images:  53%|#############################2                         | 3193/6000 [00:10<00:09, 304.72it/s]Loading training images:  54%|#############################5                         | 3226/6000 [00:10<00:08, 309.21it/s]Loading training images:  54%|#############################8                         | 3257/6000 [00:10<00:08, 308.29it/s]Loading training images:  55%|##############################1                        | 3288/6000 [00:11<00:08, 307.44it/s]Loading training images:  55%|##############################4                        | 3319/6000 [00:11<00:08, 307.74it/s]Loading training images:  56%|##############################7                        | 3353/6000 [00:11<00:08, 303.72it/s]Loading training images:  56%|###############################                        | 3390/6000 [00:11<00:08, 308.88it/s]Loading training images:  57%|###############################3                       | 3421/6000 [00:11<00:08, 305.41it/s]Loading training images:  58%|###############################6                       | 3452/6000 [00:11<00:08, 301.69it/s]Loading training images:  58%|###############################9                       | 3486/6000 [00:11<00:08, 304.15it/s]Loading training images:  59%|################################2                      | 3523/6000 [00:11<00:07, 312.01it/s]Loading training images:  59%|################################5                      | 3556/6000 [00:11<00:07, 314.58it/s]Loading training images:  60%|################################8                      | 3588/6000 [00:12<00:07, 315.03it/s]Loading training images:  60%|#################################1                     | 3620/6000 [00:12<00:07, 315.29it/s]Loading training images:  61%|#################################4                     | 3652/6000 [00:12<00:07, 316.36it/s]Loading training images:  61%|#################################7                     | 3684/6000 [00:12<00:07, 306.65it/s]Loading training images:  62%|##################################                     | 3716/6000 [00:12<00:07, 309.53it/s]Loading training images:  62%|##################################3                    | 3748/6000 [00:12<00:07, 311.41it/s]Loading training images:  63%|##################################6                    | 3780/6000 [00:12<00:07, 301.11it/s]Loading training images:  64%|##################################9                    | 3811/6000 [00:12<00:07, 298.74it/s]Loading training images:  64%|###################################2                   | 3842/6000 [00:12<00:07, 290.42it/s]Loading training images:  65%|###################################5                   | 3874/6000 [00:13<00:07, 286.19it/s]Loading training images:  65%|###################################7                   | 3903/6000 [00:13<00:07, 276.48it/s]Loading training images:  66%|####################################                   | 3931/6000 [00:13<00:07, 267.85it/s]Loading training images:  66%|####################################2                  | 3958/6000 [00:13<00:07, 267.27it/s]Loading training images:  66%|####################################5                  | 3990/6000 [00:13<00:07, 279.22it/s]Loading training images:  67%|####################################8                  | 4022/6000 [00:13<00:06, 289.08it/s]Loading training images:  68%|#####################################1                 | 4052/6000 [00:13<00:06, 291.07it/s]Loading training images:  68%|#####################################4                 | 4082/6000 [00:13<00:06, 281.44it/s]Loading training images:  69%|#####################################6                 | 4111/6000 [00:13<00:06, 275.13it/s]Loading training images:  69%|#####################################9                 | 4139/6000 [00:13<00:07, 265.54it/s]Loading training images:  70%|######################################2                | 4172/6000 [00:14<00:06, 276.92it/s]Loading training images:  70%|######################################5                | 4200/6000 [00:14<00:06, 277.70it/s]Loading training images:  70%|######################################7                | 4229/6000 [00:14<00:06, 280.78it/s]Loading training images:  71%|#######################################                | 4260/6000 [00:14<00:06, 285.03it/s]Loading training images:  72%|#######################################3               | 4291/6000 [00:14<00:05, 292.18it/s]Loading training images:  72%|#######################################6               | 4322/6000 [00:14<00:05, 294.53it/s]Loading training images:  73%|#######################################9               | 4356/6000 [00:14<00:05, 305.51it/s]Loading training images:  73%|########################################2              | 4388/6000 [00:14<00:05, 308.55it/s]Loading training images:  74%|########################################5              | 4422/6000 [00:14<00:05, 312.58it/s]Loading training images:  74%|########################################8              | 4454/6000 [00:15<00:04, 309.53it/s]Loading training images:  75%|#########################################1             | 4485/6000 [00:15<00:04, 307.67it/s]Loading training images:  75%|#########################################4             | 4517/6000 [00:15<00:04, 308.36it/s]Loading training images:  76%|#########################################7             | 4550/6000 [00:15<00:04, 309.79it/s]Loading training images:  76%|#########################################9             | 4581/6000 [00:15<00:04, 302.72it/s]Loading training images:  77%|##########################################2            | 4613/6000 [00:15<00:04, 300.21it/s]Loading training images:  77%|##########################################5            | 4645/6000 [00:15<00:04, 304.76it/s]Loading training images:  78%|##########################################8            | 4677/6000 [00:15<00:04, 306.90it/s]Loading training images:  78%|###########################################1           | 4710/6000 [00:15<00:04, 302.09it/s]Loading training images:  79%|###########################################4           | 4741/6000 [00:15<00:04, 291.95it/s]Loading training images:  80%|###########################################7           | 4771/6000 [00:16<00:04, 286.53it/s]Loading training images:  80%|############################################           | 4801/6000 [00:16<00:04, 289.44it/s]Loading training images:  81%|############################################3          | 4833/6000 [00:16<00:04, 289.39it/s]Loading training images:  81%|############################################5          | 4862/6000 [00:16<00:04, 278.62it/s]Loading training images:  82%|############################################8          | 4890/6000 [00:16<00:04, 277.08it/s]Loading training images:  82%|#############################################1         | 4924/6000 [00:16<00:03, 282.75it/s]Loading training images:  83%|#############################################4         | 4956/6000 [00:16<00:03, 280.38it/s]Loading training images:  83%|#############################################7         | 4987/6000 [00:16<00:03, 287.92it/s]Loading training images:  84%|#############################################9         | 5017/6000 [00:16<00:03, 291.30it/s]Loading training images:  84%|##############################################3        | 5051/6000 [00:17<00:03, 292.97it/s]Loading training images:  85%|##############################################5        | 5081/6000 [00:17<00:03, 293.37it/s]Loading training images:  85%|##############################################8        | 5114/6000 [00:17<00:03, 292.48it/s]Loading training images:  86%|###############################################1       | 5144/6000 [00:17<00:02, 291.79it/s]Loading training images:  86%|###############################################4       | 5174/6000 [00:17<00:02, 286.48it/s]Loading training images:  87%|###############################################7       | 5205/6000 [00:17<00:02, 287.80it/s]Loading training images:  87%|###############################################9       | 5235/6000 [00:17<00:02, 290.77it/s]Loading training images:  88%|################################################2      | 5269/6000 [00:17<00:02, 291.99it/s]Loading training images:  88%|################################################5      | 5299/6000 [00:17<00:02, 293.51it/s]Loading training images:  89%|################################################8      | 5329/6000 [00:18<00:02, 281.98it/s]Loading training images:  89%|#################################################1     | 5358/6000 [00:18<00:02, 283.11it/s]Loading training images:  90%|#################################################3     | 5389/6000 [00:18<00:02, 278.22it/s]Loading training images:  90%|#################################################6     | 5419/6000 [00:18<00:02, 283.09it/s]Loading training images:  91%|#################################################9     | 5453/6000 [00:18<00:01, 287.30it/s]Loading training images:  91%|##################################################2    | 5485/6000 [00:18<00:01, 296.27it/s]Loading training images:  92%|##################################################5    | 5519/6000 [00:18<00:01, 308.18it/s]Loading training images:  92%|##################################################8    | 5550/6000 [00:18<00:01, 308.46it/s]Loading training images:  93%|###################################################1   | 5581/6000 [00:18<00:01, 308.91it/s]Loading training images:  94%|###################################################4   | 5617/6000 [00:18<00:01, 309.88it/s]Loading training images:  94%|###################################################7   | 5649/6000 [00:19<00:01, 312.29it/s]Loading training images:  95%|####################################################   | 5681/6000 [00:19<00:01, 312.91it/s]Loading training images:  95%|####################################################4  | 5717/6000 [00:19<00:00, 313.09it/s]Loading training images:  96%|####################################################6  | 5749/6000 [00:19<00:00, 298.55it/s]Loading training images:  96%|####################################################9  | 5779/6000 [00:19<00:00, 281.47it/s]Loading training images:  97%|#####################################################2 | 5808/6000 [00:19<00:00, 274.56it/s]Loading training images:  97%|#####################################################4 | 5836/6000 [00:19<00:00, 269.08it/s]Loading training images:  98%|#####################################################7 | 5866/6000 [00:19<00:00, 273.33it/s]Loading training images:  98%|###################################################### | 5896/6000 [00:19<00:00, 280.72it/s]Loading training images:  99%|######################################################3| 5925/6000 [00:20<00:00, 283.00it/s]Loading training images:  99%|######################################################6| 5958/6000 [00:20<00:00, 284.10it/s]Loading training images: 100%|######################################################8| 5987/6000 [00:20<00:00, 281.94it/s]Loading training images: 100%|#######################################################| 6000/6000 [00:20<00:00, 295.07it/s]
Loading test images:   0%|                                                                       | 0/1500 [00:00<?, ?it/s]Loading test images:   2%|#                                                            | 26/1500 [00:00<00:05, 248.32it/s]Loading test images:   3%|##1                                                          | 52/1500 [00:00<00:05, 252.21it/s]Loading test images:   6%|###3                                                         | 83/1500 [00:00<00:05, 261.16it/s]Loading test images:   8%|####5                                                       | 114/1500 [00:00<00:04, 278.85it/s]Loading test images:  10%|#####7                                                      | 144/1500 [00:00<00:04, 285.50it/s]Loading test images:  12%|#######                                                     | 175/1500 [00:00<00:04, 286.76it/s]Loading test images:  14%|########1                                                   | 204/1500 [00:00<00:04, 285.70it/s]Loading test images:  16%|#########3                                                  | 233/1500 [00:00<00:04, 268.94it/s]Loading test images:  17%|##########4                                                 | 261/1500 [00:00<00:04, 272.05it/s]Loading test images:  19%|###########5                                                | 289/1500 [00:01<00:04, 273.13it/s]Loading test images:  21%|############7                                               | 318/1500 [00:01<00:04, 277.74it/s]Loading test images:  23%|#############9                                              | 348/1500 [00:01<00:04, 283.91it/s]Loading test images:  25%|###############                                             | 377/1500 [00:01<00:04, 280.39it/s]Loading test images:  27%|################2                                           | 406/1500 [00:01<00:03, 274.24it/s]Loading test images:  29%|#################3                                          | 434/1500 [00:01<00:03, 275.39it/s]Loading test images:  31%|##################4                                         | 462/1500 [00:01<00:03, 274.44it/s]Loading test images:  33%|###################9                                        | 498/1500 [00:01<00:03, 287.74it/s]Loading test images:  35%|#####################1                                      | 528/1500 [00:01<00:03, 288.00it/s]Loading test images:  37%|######################4                                     | 561/1500 [00:02<00:03, 290.03it/s]Loading test images:  39%|#######################6                                    | 592/1500 [00:02<00:03, 294.82it/s]Loading test images:  42%|########################9                                   | 623/1500 [00:02<00:02, 299.15it/s]Loading test images:  44%|##########################1                                 | 654/1500 [00:02<00:02, 289.32it/s]Loading test images:  46%|###########################4                                | 685/1500 [00:02<00:02, 294.31it/s]Loading test images:  48%|############################7                               | 719/1500 [00:02<00:02, 295.01it/s]Loading test images:  50%|#############################9                              | 749/1500 [00:02<00:02, 295.09it/s]Loading test images:  52%|###############################1                            | 779/1500 [00:02<00:02, 295.74it/s]Loading test images:  54%|################################3                           | 809/1500 [00:02<00:02, 285.07it/s]Loading test images:  56%|#################################5                          | 839/1500 [00:02<00:02, 289.12it/s]Loading test images:  58%|##################################7                         | 869/1500 [00:03<00:02, 291.79it/s]Loading test images:  60%|####################################                        | 902/1500 [00:03<00:01, 301.40it/s]Loading test images:  63%|#####################################5                      | 938/1500 [00:03<00:01, 305.37it/s]Loading test images:  65%|######################################7                     | 969/1500 [00:03<00:01, 305.80it/s]Loading test images:  67%|#######################################3                   | 1000/1500 [00:03<00:01, 305.56it/s]Loading test images:  69%|########################################5                  | 1031/1500 [00:03<00:01, 294.50it/s]Loading test images:  71%|#########################################8                 | 1063/1500 [00:03<00:01, 300.14it/s]Loading test images:  73%|###########################################1               | 1097/1500 [00:03<00:01, 311.61it/s]Loading test images:  75%|############################################4              | 1129/1500 [00:03<00:01, 307.60it/s]Loading test images:  77%|#############################################6             | 1161/1500 [00:04<00:01, 297.69it/s]Loading test images:  80%|###############################################            | 1196/1500 [00:04<00:01, 299.33it/s]Loading test images:  82%|################################################2          | 1227/1500 [00:04<00:00, 293.93it/s]Loading test images:  84%|#################################################4         | 1257/1500 [00:04<00:00, 293.22it/s]Loading test images:  86%|##################################################8        | 1292/1500 [00:04<00:00, 297.41it/s]Loading test images:  88%|###################################################9       | 1322/1500 [00:04<00:00, 297.18it/s]Loading test images:  90%|#####################################################2     | 1353/1500 [00:04<00:00, 300.16it/s]Loading test images:  92%|######################################################4    | 1384/1500 [00:04<00:00, 302.87it/s]Loading test images:  95%|#######################################################7   | 1418/1500 [00:04<00:00, 300.37it/s]Loading test images:  97%|#########################################################  | 1451/1500 [00:04<00:00, 307.52it/s]Loading test images:  99%|##########################################################3| 1483/1500 [00:05<00:00, 298.02it/s]Loading test images: 100%|###########################################################| 1500/1500 [00:05<00:00, 290.92it/s]

=== FINALE STATISTIKEN ===
Training shape: (6000, 200, 200, 3)
Test shape: (1500, 200, 200, 3)
Klassengewichte: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0), 4: np.float64(1.0)}

--- Verwende 80/20 Split aus data/randomized_mushrooms/inaturalist ---
Training: 6000 Bilder
Test: 1500 Bilder

Training for max 30 epochs...
Epoch 1/30
188/188 - 439s - 2s/step - accuracy: 0.2752 - loss: 1.5588 - val_accuracy: 0.2187 - val_loss: 7.1458 - learning_rate: 5.0000e-04
Epoch 2/30
188/188 - 406s - 2s/step - accuracy: 0.3302 - loss: 1.4662 - val_accuracy: 0.2153 - val_loss: 3.1533 - learning_rate: 5.0000e-04
Epoch 3/30
188/188 - 406s - 2s/step - accuracy: 0.3700 - loss: 1.4259 - val_accuracy: 0.2460 - val_loss: 4.4810 - learning_rate: 5.0000e-04
Epoch 4/30
188/188 - 407s - 2s/step - accuracy: 0.4268 - loss: 1.3444 - val_accuracy: 0.3540 - val_loss: 2.1517 - learning_rate: 5.0000e-04
Epoch 5/30
188/188 - 407s - 2s/step - accuracy: 0.4543 - loss: 1.2884 - val_accuracy: 0.2973 - val_loss: 3.9437 - learning_rate: 5.0000e-04
Epoch 6/30
188/188 - 407s - 2s/step - accuracy: 0.4803 - loss: 1.2458 - val_accuracy: 0.2527 - val_loss: 3.8865 - learning_rate: 5.0000e-04
Epoch 7/30
188/188 - 408s - 2s/step - accuracy: 0.5122 - loss: 1.1858 - val_accuracy: 0.3307 - val_loss: 2.3207 - learning_rate: 5.0000e-04
Epoch 8/30
188/188 - 406s - 2s/step - accuracy: 0.5217 - loss: 1.1620 - val_accuracy: 0.2140 - val_loss: 5.8663 - learning_rate: 5.0000e-04
Epoch 9/30
188/188 - 408s - 2s/step - accuracy: 0.5347 - loss: 1.1207 - val_accuracy: 0.3340 - val_loss: 1.6985 - learning_rate: 5.0000e-04
Epoch 10/30
188/188 - 408s - 2s/step - accuracy: 0.5543 - loss: 1.1018 - val_accuracy: 0.2913 - val_loss: 2.4418 - learning_rate: 5.0000e-04
Epoch 11/30
188/188 - 406s - 2s/step - accuracy: 0.5685 - loss: 1.0569 - val_accuracy: 0.2927 - val_loss: 3.8147 - learning_rate: 5.0000e-04

Evaluating model performance...
Final test accuracy: 0.3540

=== KLASSENWEISE PERFORMANCE ===
Phallus_impudicus: 0.5400 (300 samples)
Amanita_muscaria: 0.9300 (300 samples)
Boletus_edulis: 0.0300 (300 samples)
Cantharellus_cibarius: 0.0467 (300 samples)
Armillaria_mellea: 0.2233 (300 samples)

Confusion Matrix:
[[162 111  25   0   2]
 [ 14 279   4   1   2]
 [ 33 253   9   1   4]
 [ 53 207   8  14  18]
 [ 47 163   9  14  67]]

Classification Report:
                       precision    recall  f1-score   support

    Phallus_impudicus       0.52      0.54      0.53       300
     Amanita_muscaria       0.28      0.93      0.42       300
       Boletus_edulis       0.16      0.03      0.05       300
Cantharellus_cibarius       0.47      0.05      0.08       300
    Armillaria_mellea       0.72      0.22      0.34       300

             accuracy                           0.35      1500
            macro avg       0.43      0.35      0.29      1500
         weighted avg       0.43      0.35      0.29      1500

Modell gespeichert im Keras 3.x Format: models/mushroom_resnet50_transfer_80_20_2.keras
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
R체ckw채rtskompatible .h5 Version erstellt: models/mushroom_resnet50_transfer_80_20_2.h5

Training erfolgreich abgeschlossen mit Keras 3.x!
Echtes ResNet50-Transfermodell gespeichert im modernen .keras Format

Starting training process with 80/20 split from randomized data...

Lade randomisierte Pilzdaten f체r 80/20 Train/Test Split...
Lade Daten aus: C:\Users\strau\OneDrive\Documents\Git\sml_main\SmallLanguageModels\data\randomized_mushrooms\inaturalist
Konfigurierte Klassen: ['Phallus_impudicus', 'Amanita_muscaria', 'Boletus_edulis', 'Cantharellus_cibarius', 'Armillaria_mellea']
Anzahl Klassen: 5

1. Sammle alle Bilder aus allen Klassen...
   Phallus_impudicus: 1500 Dateien gefunden
   Amanita_muscaria: 1500 Dateien gefunden
   Boletus_edulis: 1500 Dateien gefunden
   Cantharellus_cibarius: 1500 Dateien gefunden
   Armillaria_mellea: 1500 Dateien gefunden

   Gesamt gesammelt: 7500 Dateien

2. Erstelle 80/20 Train/Test Split...
   Training: 6000 Dateien (80.0%)
   Test: 1500 Dateien (20.0%)

   Klassenverteilung im Training:
     Phallus_impudicus: 1200 Bilder
     Amanita_muscaria: 1200 Bilder
     Boletus_edulis: 1200 Bilder
     Cantharellus_cibarius: 1200 Bilder
     Armillaria_mellea: 1200 Bilder

   Klassenverteilung im Test:
     Phallus_impudicus: 300 Bilder
     Amanita_muscaria: 300 Bilder
     Boletus_edulis: 300 Bilder
     Cantharellus_cibarius: 300 Bilder
     Armillaria_mellea: 300 Bilder

3. Lade Bilddaten...
Loading training images:   0%|                                                                   | 0/6000 [00:00<?, ?it/s]Loading training images:   1%|3                                                        | 33/6000 [00:00<00:19, 303.25it/s]Loading training images:   1%|6                                                        | 64/6000 [00:00<00:19, 307.07it/s]Loading training images:   2%|9                                                        | 97/6000 [00:00<00:19, 295.48it/s]Loading training images:   2%|#1                                                      | 127/6000 [00:00<00:19, 296.84it/s]Loading training images:   3%|#4                                                      | 157/6000 [00:00<00:19, 296.89it/s]Loading training images:   3%|#7                                                      | 187/6000 [00:00<00:19, 297.67it/s]Loading training images:   4%|##                                                      | 219/6000 [00:00<00:19, 289.62it/s]Loading training images:   4%|##3                                                     | 255/6000 [00:00<00:19, 298.06it/s]Loading training images:   5%|##6                                                     | 285/6000 [00:00<00:19, 297.22it/s]Loading training images:   5%|##9                                                     | 317/6000 [00:01<00:19, 290.90it/s]Loading training images:   6%|###2                                                    | 349/6000 [00:01<00:18, 298.68it/s]Loading training images:   6%|###6                                                    | 386/6000 [00:01<00:18, 305.59it/s]Loading training images:   7%|###9                                                    | 418/6000 [00:01<00:18, 308.85it/s]Loading training images:   8%|####2                                                   | 453/6000 [00:01<00:18, 307.12it/s]Loading training images:   8%|####5                                                   | 484/6000 [00:01<00:17, 306.62it/s]Loading training images:   9%|####8                                                   | 515/6000 [00:01<00:18, 298.65it/s]Loading training images:   9%|#####                                                   | 545/6000 [00:01<00:18, 294.26it/s]Loading training images:  10%|#####3                                                  | 576/6000 [00:01<00:18, 296.99it/s]Loading training images:  10%|#####6                                                  | 610/6000 [00:02<00:18, 297.70it/s]Loading training images:  11%|#####9                                                  | 640/6000 [00:02<00:18, 297.44it/s]Loading training images:  11%|######2                                                 | 671/6000 [00:02<00:17, 299.91it/s]Loading training images:  12%|######5                                                 | 705/6000 [00:02<00:17, 298.59it/s]Loading training images:  12%|######8                                                 | 737/6000 [00:02<00:17, 303.57it/s]Loading training images:  13%|#######2                                                | 775/6000 [00:02<00:16, 311.65it/s]Loading training images:  13%|#######5                                                | 808/6000 [00:02<00:16, 315.69it/s]Loading training images:  14%|#######8                                                | 844/6000 [00:02<00:16, 315.92it/s]Loading training images:  15%|########1                                               | 876/6000 [00:02<00:16, 316.43it/s]Loading training images:  15%|########4                                               | 908/6000 [00:03<00:16, 300.30it/s]Loading training images:  16%|########7                                               | 940/6000 [00:03<00:16, 305.58it/s]Loading training images:  16%|#########1                                              | 978/6000 [00:03<00:16, 312.89it/s]Loading training images:  17%|#########2                                             | 1010/6000 [00:03<00:16, 301.76it/s]Loading training images:  17%|#########5                                             | 1041/6000 [00:03<00:16, 303.81it/s]Loading training images:  18%|#########8                                             | 1072/6000 [00:03<00:16, 305.32it/s]Loading training images:  18%|##########1                                            | 1107/6000 [00:03<00:16, 304.64it/s]Loading training images:  19%|##########4                                            | 1138/6000 [00:03<00:15, 304.71it/s]Loading training images:  20%|##########7                                            | 1174/6000 [00:03<00:15, 308.48it/s]Loading training images:  20%|###########                                            | 1205/6000 [00:03<00:15, 308.29it/s]Loading training images:  21%|###########3                                           | 1236/6000 [00:04<00:15, 298.17it/s]Loading training images:  21%|###########6                                           | 1271/6000 [00:04<00:15, 306.71it/s]Loading training images:  22%|###########9                                           | 1307/6000 [00:04<00:15, 309.22it/s]Loading training images:  22%|############2                                          | 1339/6000 [00:04<00:14, 311.02it/s]Loading training images:  23%|############5                                          | 1371/6000 [00:04<00:14, 310.37it/s]Loading training images:  23%|############8                                          | 1403/6000 [00:04<00:14, 311.29it/s]Loading training images:  24%|#############1                                         | 1435/6000 [00:04<00:14, 313.35it/s]Loading training images:  24%|#############4                                         | 1467/6000 [00:04<00:14, 315.05it/s]Loading training images:  25%|#############7                                         | 1499/6000 [00:04<00:14, 316.44it/s]Loading training images:  26%|##############                                         | 1531/6000 [00:05<00:14, 317.42it/s]Loading training images:  26%|##############3                                        | 1563/6000 [00:05<00:13, 318.18it/s]Loading training images:  27%|##############6                                        | 1595/6000 [00:05<00:14, 304.48it/s]Loading training images:  27%|##############9                                        | 1626/6000 [00:05<00:14, 305.90it/s]Loading training images:  28%|###############2                                       | 1659/6000 [00:05<00:14, 304.82it/s]Loading training images:  28%|###############4                                       | 1690/6000 [00:05<00:14, 304.09it/s]Loading training images:  29%|###############7                                       | 1723/6000 [00:05<00:14, 299.42it/s]Loading training images:  29%|################                                       | 1755/6000 [00:05<00:14, 302.97it/s]Loading training images:  30%|################3                                      | 1789/6000 [00:05<00:13, 301.26it/s]Loading training images:  30%|################6                                      | 1820/6000 [00:05<00:14, 290.19it/s]Loading training images:  31%|################9                                      | 1851/6000 [00:06<00:14, 293.59it/s]Loading training images:  31%|#################2                                     | 1884/6000 [00:06<00:14, 292.37it/s]Loading training images:  32%|#################5                                     | 1914/6000 [00:06<00:13, 293.00it/s]Loading training images:  32%|#################8                                     | 1946/6000 [00:06<00:13, 292.99it/s]Loading training images:  33%|##################1                                    | 1976/6000 [00:06<00:13, 294.92it/s]Loading training images:  33%|##################3                                    | 2006/6000 [00:06<00:13, 296.32it/s]Loading training images:  34%|##################6                                    | 2036/6000 [00:06<00:13, 297.16it/s]Loading training images:  34%|##################9                                    | 2066/6000 [00:06<00:13, 297.76it/s]Loading training images:  35%|###################2                                   | 2096/6000 [00:06<00:13, 298.18it/s]Loading training images:  35%|###################4                                   | 2126/6000 [00:07<00:13, 295.24it/s]Loading training images:  36%|###################8                                   | 2161/6000 [00:07<00:12, 300.37it/s]Loading training images:  37%|####################                                   | 2192/6000 [00:07<00:12, 302.99it/s]Loading training images:  37%|####################3                                  | 2223/6000 [00:07<00:12, 304.74it/s]Loading training images:  38%|####################6                                  | 2254/6000 [00:07<00:12, 306.24it/s]Loading training images:  38%|####################9                                  | 2285/6000 [00:07<00:12, 306.56it/s]Loading training images:  39%|#####################2                                 | 2321/6000 [00:07<00:11, 308.84it/s]Loading training images:  39%|#####################5                                 | 2354/6000 [00:07<00:11, 309.63it/s]Loading training images:  40%|#####################8                                 | 2385/6000 [00:07<00:11, 307.79it/s]Loading training images:  40%|######################1                                | 2416/6000 [00:07<00:11, 308.29it/s]Loading training images:  41%|######################4                                | 2449/6000 [00:08<00:11, 301.30it/s]Loading training images:  41%|######################7                                | 2483/6000 [00:08<00:11, 312.03it/s]Loading training images:  42%|#######################                                | 2518/6000 [00:08<00:11, 309.84it/s]Loading training images:  42%|#######################3                               | 2550/6000 [00:08<00:11, 310.09it/s]Loading training images:  43%|#######################6                               | 2583/6000 [00:08<00:11, 303.19it/s]Loading training images:  44%|#######################9                               | 2617/6000 [00:08<00:11, 300.82it/s]Loading training images:  44%|########################3                              | 2651/6000 [00:08<00:10, 311.67it/s]Loading training images:  45%|########################5                              | 2683/6000 [00:08<00:10, 313.86it/s]Loading training images:  45%|########################9                              | 2717/6000 [00:08<00:10, 307.58it/s]Loading training images:  46%|#########################2                             | 2755/6000 [00:09<00:10, 314.29it/s]Loading training images:  46%|#########################5                             | 2787/6000 [00:09<00:10, 313.91it/s]Loading training images:  47%|#########################8                             | 2819/6000 [00:09<00:10, 314.87it/s]Loading training images:  48%|##########################1                            | 2851/6000 [00:09<00:10, 301.89it/s]Loading training images:  48%|##########################4                            | 2882/6000 [00:09<00:10, 302.66it/s]Loading training images:  49%|##########################7                            | 2915/6000 [00:09<00:10, 297.59it/s]Loading training images:  49%|##########################9                            | 2945/6000 [00:09<00:10, 297.31it/s]Loading training images:  50%|###########################2                           | 2975/6000 [00:09<00:10, 298.03it/s]Loading training images:  50%|###########################5                           | 3008/6000 [00:09<00:10, 294.01it/s]Loading training images:  51%|###########################8                           | 3038/6000 [00:10<00:10, 294.12it/s]Loading training images:  51%|############################1                          | 3068/6000 [00:10<00:10, 282.88it/s]Loading training images:  52%|############################3                          | 3097/6000 [00:10<00:10, 284.85it/s]Loading training images:  52%|############################6                          | 3126/6000 [00:10<00:10, 286.11it/s]Loading training images:  53%|############################9                          | 3156/6000 [00:10<00:09, 289.99it/s]Loading training images:  53%|#############################2                         | 3186/6000 [00:10<00:09, 292.88it/s]Loading training images:  54%|#############################5                         | 3219/6000 [00:10<00:09, 303.56it/s]Loading training images:  54%|#############################7                         | 3250/6000 [00:10<00:09, 305.30it/s]Loading training images:  55%|##############################                         | 3281/6000 [00:10<00:08, 306.67it/s]Loading training images:  55%|##############################3                        | 3314/6000 [00:10<00:08, 299.25it/s]Loading training images:  56%|##############################6                        | 3349/6000 [00:11<00:08, 300.87it/s]Loading training images:  56%|##############################9                        | 3380/6000 [00:11<00:08, 302.61it/s]Loading training images:  57%|###############################3                       | 3417/6000 [00:11<00:08, 308.54it/s]Loading training images:  57%|###############################6                       | 3448/6000 [00:11<00:08, 307.02it/s]Loading training images:  58%|###############################9                       | 3484/6000 [00:11<00:08, 308.76it/s]Loading training images:  59%|################################2                      | 3517/6000 [00:11<00:07, 313.12it/s]Loading training images:  59%|################################5                      | 3555/6000 [00:11<00:07, 318.91it/s]Loading training images:  60%|################################8                      | 3587/6000 [00:11<00:07, 318.71it/s]Loading training images:  60%|#################################1                     | 3619/6000 [00:11<00:07, 318.80it/s]Loading training images:  61%|#################################4                     | 3651/6000 [00:12<00:07, 300.74it/s]Loading training images:  61%|#################################7                     | 3682/6000 [00:12<00:07, 290.69it/s]Loading training images:  62%|##################################                     | 3712/6000 [00:12<00:07, 293.07it/s]Loading training images:  62%|##################################3                    | 3742/6000 [00:12<00:07, 294.88it/s]Loading training images:  63%|##################################5                    | 3772/6000 [00:12<00:07, 296.24it/s]Loading training images:  63%|##################################8                    | 3802/6000 [00:12<00:07, 286.31it/s]Loading training images:  64%|###################################1                   | 3833/6000 [00:12<00:07, 281.06it/s]Loading training images:  64%|###################################4                   | 3867/6000 [00:12<00:07, 296.19it/s]Loading training images:  65%|###################################7                   | 3899/6000 [00:12<00:07, 291.47it/s]Loading training images:  65%|####################################                   | 3929/6000 [00:12<00:07, 293.12it/s]Loading training images:  66%|####################################2                  | 3959/6000 [00:13<00:06, 294.07it/s]Loading training images:  66%|####################################5                  | 3989/6000 [00:13<00:06, 295.56it/s]Loading training images:  67%|####################################8                  | 4022/6000 [00:13<00:06, 305.63it/s]Loading training images:  68%|#####################################1                 | 4058/6000 [00:13<00:06, 308.47it/s]Loading training images:  68%|#####################################4                 | 4089/6000 [00:13<00:06, 307.51it/s]Loading training images:  69%|#####################################7                 | 4120/6000 [00:13<00:06, 287.01it/s]Loading training images:  69%|######################################                 | 4156/6000 [00:13<00:06, 294.62it/s]Loading training images:  70%|######################################3                | 4186/6000 [00:13<00:06, 296.06it/s]Loading training images:  70%|######################################6                | 4216/6000 [00:13<00:06, 297.12it/s]Loading training images:  71%|######################################9                | 4246/6000 [00:14<00:05, 297.73it/s]Loading training images:  71%|#######################################1               | 4276/6000 [00:14<00:05, 298.33it/s]Loading training images:  72%|#######################################4               | 4306/6000 [00:14<00:05, 285.48it/s]Loading training images:  72%|#######################################7               | 4340/6000 [00:14<00:05, 293.68it/s]Loading training images:  73%|########################################               | 4372/6000 [00:14<00:05, 300.86it/s]Loading training images:  73%|########################################3              | 4403/6000 [00:14<00:05, 302.67it/s]Loading training images:  74%|########################################6              | 4434/6000 [00:14<00:05, 304.77it/s]Loading training images:  74%|########################################9              | 4466/6000 [00:14<00:05, 296.22it/s]Loading training images:  75%|#########################################2             | 4496/6000 [00:14<00:05, 296.88it/s]Loading training images:  76%|#########################################5             | 4530/6000 [00:14<00:04, 307.89it/s]Loading training images:  76%|#########################################8             | 4564/6000 [00:15<00:04, 303.85it/s]Loading training images:  77%|##########################################1            | 4595/6000 [00:15<00:04, 303.75it/s]Loading training images:  77%|##########################################4            | 4626/6000 [00:15<00:04, 284.14it/s]Loading training images:  78%|##########################################6            | 4655/6000 [00:15<00:05, 250.46it/s]Loading training images:  78%|##########################################9            | 4681/6000 [00:15<00:05, 250.18it/s]Loading training images:  78%|###########################################1           | 4707/6000 [00:15<00:05, 252.16it/s]Loading training images:  79%|###########################################3           | 4733/6000 [00:15<00:05, 243.46it/s]Loading training images:  79%|###########################################6           | 4759/6000 [00:15<00:05, 247.24it/s]Loading training images:  80%|###########################################8           | 4789/6000 [00:16<00:04, 261.29it/s]Loading training images:  80%|############################################2          | 4823/6000 [00:16<00:04, 273.32it/s]Loading training images:  81%|############################################4          | 4853/6000 [00:16<00:04, 279.51it/s]Loading training images:  81%|############################################7          | 4886/6000 [00:16<00:03, 284.65it/s]Loading training images:  82%|#############################################1         | 4921/6000 [00:16<00:03, 290.41it/s]Loading training images:  83%|#############################################3         | 4951/6000 [00:16<00:03, 291.32it/s]Loading training images:  83%|#############################################6         | 4981/6000 [00:16<00:03, 290.22it/s]Loading training images:  84%|#############################################9         | 5015/6000 [00:16<00:03, 291.58it/s]Loading training images:  84%|##############################################2        | 5045/6000 [00:16<00:03, 292.19it/s]Loading training images:  85%|##############################################5        | 5080/6000 [00:16<00:03, 297.03it/s]Loading training images:  85%|##############################################8        | 5110/6000 [00:17<00:02, 296.85it/s]Loading training images:  86%|###############################################1       | 5140/6000 [00:17<00:03, 284.67it/s]Loading training images:  86%|###############################################3       | 5169/6000 [00:17<00:02, 284.78it/s]Loading training images:  87%|###############################################6       | 5203/6000 [00:17<00:02, 288.19it/s]Loading training images:  87%|###############################################9       | 5232/6000 [00:17<00:02, 287.21it/s]Loading training images:  88%|################################################2      | 5265/6000 [00:17<00:02, 288.13it/s]Loading training images:  88%|################################################5      | 5298/6000 [00:17<00:02, 287.34it/s]Loading training images:  89%|################################################8      | 5327/6000 [00:17<00:02, 288.01it/s]Loading training images:  89%|#################################################      | 5356/6000 [00:17<00:02, 288.34it/s]Loading training images:  90%|#################################################3     | 5385/6000 [00:18<00:02, 288.65it/s]Loading training images:  90%|#################################################6     | 5414/6000 [00:18<00:02, 287.27it/s]Loading training images:  91%|#################################################9     | 5448/6000 [00:18<00:01, 289.62it/s]Loading training images:  91%|##################################################2    | 5479/6000 [00:18<00:01, 294.64it/s]Loading training images:  92%|##################################################5    | 5512/6000 [00:18<00:01, 304.15it/s]Loading training images:  92%|##################################################8    | 5543/6000 [00:18<00:01, 305.57it/s]Loading training images:  93%|###################################################    | 5574/6000 [00:18<00:01, 294.05it/s]Loading training images:  93%|###################################################3   | 5605/6000 [00:18<00:01, 296.47it/s]Loading training images:  94%|###################################################6   | 5636/6000 [00:18<00:01, 288.88it/s]Loading training images:  94%|###################################################9   | 5665/6000 [00:19<00:01, 288.12it/s]Loading training images:  95%|####################################################2  | 5695/6000 [00:19<00:01, 290.91it/s]Loading training images:  95%|####################################################5  | 5729/6000 [00:19<00:00, 293.33it/s]Loading training images:  96%|####################################################8  | 5761/6000 [00:19<00:00, 298.84it/s]Loading training images:  97%|#####################################################1 | 5795/6000 [00:19<00:00, 295.94it/s]Loading training images:  97%|#####################################################4 | 5832/6000 [00:19<00:00, 303.54it/s]Loading training images:  98%|#####################################################7 | 5863/6000 [00:19<00:00, 305.11it/s]Loading training images:  98%|###################################################### | 5894/6000 [00:19<00:00, 305.92it/s]Loading training images:  99%|######################################################3| 5925/6000 [00:19<00:00, 306.52it/s]Loading training images:  99%|######################################################5| 5956/6000 [00:19<00:00, 294.06it/s]Loading training images: 100%|######################################################9| 5993/6000 [00:20<00:00, 302.72it/s]Loading training images: 100%|#######################################################| 6000/6000 [00:20<00:00, 298.23it/s]
Loading test images:   0%|                                                                       | 0/1500 [00:00<?, ?it/s]Loading test images:   2%|#3                                                           | 32/1500 [00:00<00:05, 288.34it/s]Loading test images:   4%|##5                                                          | 62/1500 [00:00<00:04, 292.87it/s]Loading test images:   6%|###8                                                         | 94/1500 [00:00<00:04, 302.32it/s]Loading test images:   8%|#####                                                       | 125/1500 [00:00<00:04, 305.03it/s]Loading test images:  10%|######2                                                     | 156/1500 [00:00<00:04, 304.43it/s]Loading test images:  12%|#######4                                                    | 187/1500 [00:00<00:04, 303.32it/s]Loading test images:  15%|########7                                                   | 218/1500 [00:00<00:04, 294.92it/s]Loading test images:  17%|#########9                                                  | 248/1500 [00:00<00:04, 296.09it/s]Loading test images:  19%|###########1                                                | 278/1500 [00:00<00:04, 281.41it/s]Loading test images:  20%|############2                                               | 307/1500 [00:01<00:04, 281.01it/s]Loading test images:  23%|#############7                                              | 344/1500 [00:01<00:03, 300.30it/s]Loading test images:  25%|###############                                             | 377/1500 [00:01<00:03, 307.28it/s]Loading test images:  27%|################4                                           | 412/1500 [00:01<00:03, 306.81it/s]Loading test images:  30%|#################7                                          | 443/1500 [00:01<00:03, 305.94it/s]Loading test images:  32%|##################9                                         | 474/1500 [00:01<00:03, 302.78it/s]Loading test images:  34%|####################5                                       | 514/1500 [00:01<00:03, 316.70it/s]Loading test images:  37%|#####################9                                      | 549/1500 [00:01<00:03, 312.45it/s]Loading test images:  39%|#######################3                                    | 584/1500 [00:01<00:02, 311.61it/s]Loading test images:  41%|########################6                                   | 616/1500 [00:02<00:02, 313.01it/s]Loading test images:  43%|#########################9                                  | 648/1500 [00:02<00:02, 314.15it/s]Loading test images:  46%|###########################3                                | 684/1500 [00:02<00:02, 314.59it/s]Loading test images:  48%|############################6                               | 716/1500 [00:02<00:02, 313.87it/s]Loading test images:  50%|#############################9                              | 748/1500 [00:02<00:02, 303.40it/s]Loading test images:  52%|###############################1                            | 779/1500 [00:02<00:02, 303.86it/s]Loading test images:  54%|################################4                           | 810/1500 [00:02<00:02, 292.26it/s]Loading test images:  56%|#################################7                          | 844/1500 [00:02<00:02, 298.38it/s]Loading test images:  58%|##################################9                         | 874/1500 [00:02<00:02, 298.66it/s]Loading test images:  61%|####################################4                       | 911/1500 [00:03<00:01, 305.58it/s]Loading test images:  63%|#####################################6                      | 942/1500 [00:03<00:01, 306.57it/s]Loading test images:  65%|######################################9                     | 973/1500 [00:03<00:01, 300.09it/s]Loading test images:  67%|#######################################5                   | 1006/1500 [00:03<00:01, 295.61it/s]Loading test images:  69%|########################################7                  | 1036/1500 [00:03<00:01, 295.81it/s]Loading test images:  71%|#########################################9                 | 1066/1500 [00:03<00:01, 286.08it/s]Loading test images:  73%|###########################################2               | 1100/1500 [00:03<00:01, 298.00it/s]Loading test images:  75%|############################################5              | 1132/1500 [00:03<00:01, 291.60it/s]Loading test images:  78%|#############################################7             | 1163/1500 [00:03<00:01, 295.19it/s]Loading test images:  80%|###############################################1           | 1198/1500 [00:03<00:01, 298.03it/s]Loading test images:  82%|################################################3          | 1229/1500 [00:04<00:00, 301.11it/s]Loading test images:  84%|#################################################5         | 1260/1500 [00:04<00:00, 303.16it/s]Loading test images:  86%|##################################################7        | 1291/1500 [00:04<00:00, 295.81it/s]Loading test images:  88%|###################################################9       | 1321/1500 [00:04<00:00, 296.57it/s]Loading test images:  90%|#####################################################2     | 1353/1500 [00:04<00:00, 303.24it/s]Loading test images:  92%|######################################################4    | 1385/1500 [00:04<00:00, 307.95it/s]Loading test images:  95%|#######################################################8   | 1420/1500 [00:04<00:00, 306.33it/s]Loading test images:  97%|#########################################################  | 1451/1500 [00:04<00:00, 304.87it/s]Loading test images:  99%|##########################################################2| 1482/1500 [00:04<00:00, 304.13it/s]Loading test images: 100%|###########################################################| 1500/1500 [00:04<00:00, 300.73it/s]

=== FINALE STATISTIKEN ===
Training shape: (6000, 200, 200, 3)
Test shape: (1500, 200, 200, 3)
Klassengewichte: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0), 4: np.float64(1.0)}

--- Verwende 80/20 Split aus data/randomized_mushrooms/inaturalist ---
Training: 6000 Bilder
Test: 1500 Bilder

Building 7-class ResNet-inspired CNN model for mushroom classification (Keras 3.x EXKLUSIV)...
ResNet-inspiriertes Modell erfolgreich erstellt f체r 5 Klassen mit Keras 3.x Functional API
Verwendet: Residual Connections + GlobalAveragePooling2D + reduzierte Parameter

Training for max 30 epochs...
Epoch 1/30
188/188 - 113s - 599ms/step - accuracy: 0.4912 - loss: 2.6925 - val_accuracy: 0.1993 - val_loss: 2.6324 - learning_rate: 1.0000e-03
Epoch 2/30
188/188 - 105s - 560ms/step - accuracy: 0.6287 - loss: 1.7179 - val_accuracy: 0.2500 - val_loss: 2.2169 - learning_rate: 1.0000e-03
Epoch 3/30
188/188 - 105s - 560ms/step - accuracy: 0.6947 - loss: 1.2349 - val_accuracy: 0.4980 - val_loss: 1.8698 - learning_rate: 1.0000e-03
Epoch 4/30
188/188 - 107s - 567ms/step - accuracy: 0.7235 - loss: 0.9953 - val_accuracy: 0.5413 - val_loss: 1.8005 - learning_rate: 1.0000e-03
Epoch 5/30
188/188 - 105s - 558ms/step - accuracy: 0.7432 - loss: 0.8537 - val_accuracy: 0.5320 - val_loss: 1.5021 - learning_rate: 1.0000e-03
Epoch 6/30
188/188 - 105s - 561ms/step - accuracy: 0.7550 - loss: 0.7625 - val_accuracy: 0.5313 - val_loss: 1.3604 - learning_rate: 1.0000e-03
Epoch 7/30
188/188 - 105s - 560ms/step - accuracy: 0.7770 - loss: 0.6655 - val_accuracy: 0.4180 - val_loss: 1.7855 - learning_rate: 1.0000e-03
Epoch 8/30
188/188 - 105s - 561ms/step - accuracy: 0.7920 - loss: 0.6194 - val_accuracy: 0.5487 - val_loss: 1.4234 - learning_rate: 1.0000e-03
Epoch 9/30
188/188 - 106s - 562ms/step - accuracy: 0.8047 - loss: 0.5878 - val_accuracy: 0.6013 - val_loss: 1.3303 - learning_rate: 1.0000e-03
Epoch 10/30
188/188 - 105s - 559ms/step - accuracy: 0.8182 - loss: 0.5565 - val_accuracy: 0.6773 - val_loss: 0.9393 - learning_rate: 1.0000e-03
Epoch 11/30
188/188 - 105s - 556ms/step - accuracy: 0.8278 - loss: 0.5298 - val_accuracy: 0.5420 - val_loss: 1.5058 - learning_rate: 1.0000e-03
Epoch 12/30
188/188 - 106s - 563ms/step - accuracy: 0.8360 - loss: 0.4856 - val_accuracy: 0.7773 - val_loss: 0.6487 - learning_rate: 1.0000e-03
Epoch 13/30
188/188 - 105s - 556ms/step - accuracy: 0.8582 - loss: 0.4438 - val_accuracy: 0.6427 - val_loss: 1.1555 - learning_rate: 1.0000e-03
Epoch 14/30
188/188 - 104s - 556ms/step - accuracy: 0.8580 - loss: 0.4509 - val_accuracy: 0.5920 - val_loss: 1.6071 - learning_rate: 1.0000e-03
Epoch 15/30
188/188 - 105s - 560ms/step - accuracy: 0.8608 - loss: 0.4240 - val_accuracy: 0.7347 - val_loss: 0.7188 - learning_rate: 1.0000e-03
Epoch 16/30
188/188 - 104s - 556ms/step - accuracy: 0.8678 - loss: 0.4060 - val_accuracy: 0.6647 - val_loss: 1.1810 - learning_rate: 1.0000e-03
Epoch 17/30
188/188 - 105s - 557ms/step - accuracy: 0.8762 - loss: 0.3812 - val_accuracy: 0.6740 - val_loss: 1.1221 - learning_rate: 1.0000e-03
Epoch 18/30
188/188 - 105s - 556ms/step - accuracy: 0.9155 - loss: 0.2830 - val_accuracy: 0.8353 - val_loss: 0.5211 - learning_rate: 5.0000e-04
Epoch 19/30
188/188 - 105s - 558ms/step - accuracy: 0.9327 - loss: 0.2250 - val_accuracy: 0.8300 - val_loss: 0.5289 - learning_rate: 5.0000e-04
Epoch 20/30
188/188 - 105s - 556ms/step - accuracy: 0.9333 - loss: 0.2185 - val_accuracy: 0.7680 - val_loss: 0.8438 - learning_rate: 5.0000e-04
Epoch 21/30
188/188 - 105s - 559ms/step - accuracy: 0.9402 - loss: 0.2009 - val_accuracy: 0.8060 - val_loss: 0.6689 - learning_rate: 5.0000e-04
Epoch 22/30
188/188 - 105s - 557ms/step - accuracy: 0.9493 - loss: 0.1691 - val_accuracy: 0.7773 - val_loss: 0.8103 - learning_rate: 5.0000e-04
Epoch 23/30
188/188 - 105s - 559ms/step - accuracy: 0.9532 - loss: 0.1627 - val_accuracy: 0.7433 - val_loss: 0.9956 - learning_rate: 5.0000e-04
Epoch 24/30
188/188 - 105s - 557ms/step - accuracy: 0.9710 - loss: 0.1122 - val_accuracy: 0.7573 - val_loss: 0.8353 - learning_rate: 2.5000e-04
Epoch 25/30
188/188 - 106s - 563ms/step - accuracy: 0.9747 - loss: 0.0947 - val_accuracy: 0.8480 - val_loss: 0.5503 - learning_rate: 2.5000e-04
Epoch 26/30
188/188 - 106s - 565ms/step - accuracy: 0.9808 - loss: 0.0816 - val_accuracy: 0.8187 - val_loss: 0.7901 - learning_rate: 2.5000e-04
Epoch 27/30
188/188 - 105s - 561ms/step - accuracy: 0.9798 - loss: 0.0776 - val_accuracy: 0.8293 - val_loss: 0.7351 - learning_rate: 2.5000e-04
Epoch 28/30
188/188 - 105s - 560ms/step - accuracy: 0.9845 - loss: 0.0665 - val_accuracy: 0.8387 - val_loss: 0.6672 - learning_rate: 2.5000e-04
Epoch 29/30
188/188 - 105s - 560ms/step - accuracy: 0.9885 - loss: 0.0531 - val_accuracy: 0.8360 - val_loss: 0.6603 - learning_rate: 1.2500e-04
Epoch 30/30
188/188 - 105s - 559ms/step - accuracy: 0.9873 - loss: 0.0548 - val_accuracy: 0.8520 - val_loss: 0.6223 - learning_rate: 1.2500e-04

Evaluating model performance...
Final test accuracy: 0.8480

=== KLASSENWEISE PERFORMANCE ===
Phallus_impudicus: 0.8733 (300 samples)
Amanita_muscaria: 0.8633 (300 samples)
Boletus_edulis: 0.8033 (300 samples)
Cantharellus_cibarius: 0.9367 (300 samples)
Armillaria_mellea: 0.7633 (300 samples)

Confusion Matrix:
[[262   2  13   4  19]
 [  9 259  16   9   7]
 [ 22   4 241   5  28]
 [  2   5   1 281  11]
 [ 12   4  25  30 229]]

Classification Report:
                       precision    recall  f1-score   support

    Phallus_impudicus       0.85      0.87      0.86       300
     Amanita_muscaria       0.95      0.86      0.90       300
       Boletus_edulis       0.81      0.80      0.81       300
Cantharellus_cibarius       0.85      0.94      0.89       300
    Armillaria_mellea       0.78      0.76      0.77       300

             accuracy                           0.85      1500
            macro avg       0.85      0.85      0.85      1500
         weighted avg       0.85      0.85      0.85      1500

Modell gespeichert im Keras 3.x Format: models/mushroom_5class_resnet_cnn_80_20_split_2.keras
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
R체ckw채rtskompatible .h5 Version erstellt: models/mushroom_5class_resnet_cnn_80_20_split_2.h5

Training erfolgreich abgeschlossen mit Keras 3.x!
ResNet-inspiriertes 5-Klassen Modell mit 80/20 Split gespeichert im modernen .keras Format
