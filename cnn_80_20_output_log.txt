
MUSHROOM CLASSIFICATION CNN - 5 CLASSES + RESIDUAL CONNECTIONS (TensorFlow 2.19.1 & Keras 3.x EXKLUSIV)
==========================================================================================
Classes: Amanita_muscaria, Boletus_edulis, Armillaria_mellea, Tylopilus_felleus, Suillellus_luridus, Amanita_phalloides, Imleria_badia
Architecture: ResNet-inspired with Residual Connections + GlobalAveragePooling2D
Improvements: Skip Connections, Reduced Parameters, Better Gradient Flow
Data: 80/20 split from data/randomized_mushrooms/inaturalist
Training: Randomized 200x200 images (80%)
Testing: Randomized 200x200 images (20%)
Output: Modern .keras format (with .h5 fallback for compatibility)
KERAS 3.x ERFORDERLICH - Keine Fallbacks!
==========================================================================================

Starting training process with 80/20 split from randomized data...

Lade randomisierte Pilzdaten f√ºr 80/20 Train/Test Split...
Lade Daten aus: C:\Users\strau\OneDrive\Documents\Git\sml_main\SmallLanguageModels\data\randomized_mushrooms\inaturalist
Konfigurierte Klassen: ['Phallus_impudicus', 'Amanita_muscaria', 'Boletus_edulis', 'Cantharellus_cibarius', 'Armillaria_mellea']
Anzahl Klassen: 5

1. Sammle alle Bilder aus allen Klassen...
   Phallus_impudicus: 1500 Dateien gefunden
   Amanita_muscaria: 1500 Dateien gefunden
   Boletus_edulis: 1500 Dateien gefunden
   Cantharellus_cibarius: 1500 Dateien gefunden
   Armillaria_mellea: 1500 Dateien gefunden

   Gesamt gesammelt: 7500 Dateien

2. Erstelle 80/20 Train/Test Split...
   Training: 6000 Dateien (80.0%)
   Test: 1500 Dateien (20.0%)

   Klassenverteilung im Training:
     Phallus_impudicus: 1200 Bilder
     Amanita_muscaria: 1200 Bilder
     Boletus_edulis: 1200 Bilder
     Cantharellus_cibarius: 1200 Bilder
     Armillaria_mellea: 1200 Bilder

   Klassenverteilung im Test:
     Phallus_impudicus: 300 Bilder
     Amanita_muscaria: 300 Bilder
     Boletus_edulis: 300 Bilder
     Cantharellus_cibarius: 300 Bilder
     Armillaria_mellea: 300 Bilder

3. Lade Bilddaten...
Loading training images:   0%|                                                                                                               | 0/6000 [00:00<?, ?it/s]Loading training images:   1%|5                                                                                                    | 32/6000 [00:00<00:19, 308.84it/s]Loading training images:   1%|#1                                                                                                   | 68/6000 [00:00<00:18, 321.50it/s]Loading training images:   2%|#6                                                                                                  | 101/6000 [00:00<00:18, 319.20it/s]Loading training images:   2%|##2                                                                                                 | 135/6000 [00:00<00:18, 310.88it/s]Loading training images:   3%|##8                                                                                                 | 172/6000 [00:00<00:18, 314.52it/s]Loading training images:   3%|###4                                                                                                | 204/6000 [00:00<00:18, 314.79it/s]Loading training images:   4%|####                                                                                                | 241/6000 [00:00<00:18, 315.90it/s]Loading training images:   5%|####5                                                                                               | 273/6000 [00:00<00:18, 317.01it/s]Loading training images:   5%|#####1                                                                                              | 306/6000 [00:00<00:18, 305.92it/s]Loading training images:   6%|#####6                                                                                              | 340/6000 [00:01<00:17, 314.85it/s]Loading training images:   6%|######2                                                                                             | 376/6000 [00:01<00:17, 315.01it/s]Loading training images:   7%|######8                                                                                             | 412/6000 [00:01<00:17, 325.54it/s]Loading training images:   8%|#######5                                                                                            | 451/6000 [00:01<00:16, 328.69it/s]Loading training images:   8%|########1                                                                                           | 488/6000 [00:01<00:16, 327.06it/s]Loading training images:   9%|########6                                                                                           | 521/6000 [00:01<00:16, 326.14it/s]Loading training images:   9%|#########2                                                                                          | 556/6000 [00:01<00:17, 319.47it/s]Loading training images:  10%|#########8                                                                                          | 590/6000 [00:01<00:16, 323.17it/s]Loading training images:  10%|##########3                                                                                         | 623/6000 [00:01<00:16, 324.37it/s]Loading training images:  11%|###########                                                                                         | 661/6000 [00:02<00:16, 327.80it/s]Loading training images:  12%|###########5                                                                                        | 694/6000 [00:02<00:16, 326.00it/s]Loading training images:  12%|############1                                                                                       | 731/6000 [00:02<00:16, 324.59it/s]Loading training images:  13%|############7                                                                                       | 767/6000 [00:02<00:15, 333.26it/s]Loading training images:  13%|#############3                                                                                      | 801/6000 [00:02<00:15, 334.34it/s]Loading training images:  14%|#############9                                                                                      | 835/6000 [00:02<00:15, 335.78it/s]Loading training images:  14%|##############4                                                                                     | 869/6000 [00:02<00:15, 336.71it/s]Loading training images:  15%|###############                                                                                     | 903/6000 [00:02<00:15, 337.47it/s]Loading training images:  16%|###############6                                                                                    | 937/6000 [00:02<00:15, 327.12it/s]Loading training images:  16%|################2                                                                                   | 972/6000 [00:02<00:15, 329.39it/s]Loading training images:  17%|################6                                                                                  | 1008/6000 [00:03<00:15, 324.02it/s]Loading training images:  17%|#################1                                                                                 | 1041/6000 [00:03<00:16, 299.83it/s]Loading training images:  18%|#################7                                                                                 | 1076/6000 [00:03<00:15, 312.01it/s]Loading training images:  18%|##################3                                                                                | 1110/6000 [00:03<00:15, 317.70it/s]Loading training images:  19%|##################8                                                                                | 1143/6000 [00:03<00:15, 319.33it/s]Loading training images:  20%|###################4                                                                               | 1179/6000 [00:03<00:15, 319.90it/s]Loading training images:  20%|####################                                                                               | 1213/6000 [00:03<00:14, 324.50it/s]Loading training images:  21%|####################6                                                                              | 1249/6000 [00:03<00:14, 332.69it/s]Loading training images:  21%|#####################2                                                                             | 1289/6000 [00:03<00:13, 338.38it/s]Loading training images:  22%|#####################8                                                                             | 1323/6000 [00:04<00:14, 333.74it/s]Loading training images:  23%|######################4                                                                            | 1359/6000 [00:04<00:13, 339.93it/s]Loading training images:  23%|#######################                                                                            | 1394/6000 [00:04<00:13, 342.66it/s]Loading training images:  24%|#######################5                                                                           | 1429/6000 [00:04<00:13, 334.28it/s]Loading training images:  24%|########################1                                                                          | 1466/6000 [00:04<00:13, 339.03it/s]Loading training images:  25%|########################7                                                                          | 1500/6000 [00:04<00:13, 337.35it/s]Loading training images:  26%|#########################3                                                                         | 1535/6000 [00:04<00:13, 332.83it/s]Loading training images:  26%|#########################8                                                                         | 1569/6000 [00:04<00:17, 259.84it/s]Loading training images:  27%|##########################4                                                                        | 1606/6000 [00:05<00:15, 276.40it/s]Loading training images:  27%|###########################                                                                        | 1637/6000 [00:05<00:15, 284.07it/s]Loading training images:  28%|###########################5                                                                       | 1670/6000 [00:05<00:14, 295.89it/s]Loading training images:  28%|############################1                                                                      | 1707/6000 [00:05<00:14, 302.66it/s]Loading training images:  29%|############################7                                                                      | 1742/6000 [00:05<00:13, 314.84it/s]Loading training images:  30%|#############################3                                                                     | 1778/6000 [00:05<00:13, 313.98it/s]Loading training images:  30%|#############################8                                                                     | 1810/6000 [00:05<00:13, 312.62it/s]Loading training images:  31%|##############################4                                                                    | 1845/6000 [00:05<00:13, 312.69it/s]Loading training images:  31%|##############################9                                                                    | 1877/6000 [00:05<00:13, 309.87it/s]Loading training images:  32%|###############################5                                                                   | 1910/6000 [00:05<00:13, 309.61it/s]Loading training images:  32%|################################                                                                   | 1942/6000 [00:06<00:12, 312.48it/s]Loading training images:  33%|################################5                                                                  | 1974/6000 [00:06<00:12, 314.38it/s]Loading training images:  33%|#################################1                                                                 | 2007/6000 [00:06<00:12, 317.64it/s]Loading training images:  34%|#################################6                                                                 | 2039/6000 [00:06<00:12, 313.20it/s]Loading training images:  35%|##################################2                                                                | 2074/6000 [00:06<00:12, 315.78it/s]Loading training images:  35%|##################################8                                                                | 2112/6000 [00:06<00:12, 319.97it/s]Loading training images:  36%|###################################4                                                               | 2146/6000 [00:06<00:12, 315.92it/s]Loading training images:  36%|####################################                                                               | 2183/6000 [00:06<00:11, 318.81it/s]Loading training images:  37%|####################################5                                                              | 2216/6000 [00:06<00:11, 321.72it/s]Loading training images:  38%|#####################################1                                                             | 2254/6000 [00:07<00:11, 325.36it/s]Loading training images:  38%|#####################################7                                                             | 2287/6000 [00:07<00:11, 326.01it/s]Loading training images:  39%|######################################2                                                            | 2320/6000 [00:07<00:11, 323.42it/s]Loading training images:  39%|######################################8                                                            | 2353/6000 [00:07<00:11, 323.29it/s]Loading training images:  40%|#######################################4                                                           | 2389/6000 [00:07<00:11, 323.30it/s]Loading training images:  40%|#######################################9                                                           | 2424/6000 [00:07<00:10, 330.83it/s]Loading training images:  41%|########################################5                                                          | 2458/6000 [00:07<00:10, 333.44it/s]Loading training images:  42%|#########################################1                                                         | 2495/6000 [00:07<00:10, 342.49it/s]Loading training images:  42%|#########################################7                                                         | 2530/6000 [00:07<00:10, 334.35it/s]Loading training images:  43%|##########################################3                                                        | 2564/6000 [00:07<00:10, 333.91it/s]Loading training images:  43%|##########################################8                                                        | 2598/6000 [00:08<00:10, 335.66it/s]Loading training images:  44%|###########################################4                                                       | 2632/6000 [00:08<00:10, 336.78it/s]Loading training images:  44%|###########################################9                                                       | 2666/6000 [00:08<00:09, 337.53it/s]Loading training images:  45%|############################################5                                                      | 2700/6000 [00:08<00:09, 335.41it/s]Loading training images:  46%|#############################################1                                                     | 2737/6000 [00:08<00:09, 333.03it/s]Loading training images:  46%|#############################################7                                                     | 2771/6000 [00:08<00:09, 334.97it/s]Loading training images:  47%|##############################################2                                                    | 2805/6000 [00:08<00:09, 336.16it/s]Loading training images:  47%|##############################################8                                                    | 2839/6000 [00:08<00:09, 334.51it/s]Loading training images:  48%|###############################################4                                                   | 2873/6000 [00:08<00:09, 322.53it/s]Loading training images:  48%|###############################################9                                                   | 2906/6000 [00:09<00:09, 323.04it/s]Loading training images:  49%|################################################4                                                  | 2939/6000 [00:09<00:09, 309.89it/s]Loading training images:  50%|#################################################                                                  | 2971/6000 [00:09<00:09, 311.05it/s]Loading training images:  50%|#################################################5                                                 | 3004/6000 [00:09<00:09, 315.68it/s]Loading training images:  51%|##################################################1                                                | 3037/6000 [00:09<00:09, 308.96it/s]Loading training images:  51%|##################################################6                                                | 3070/6000 [00:09<00:09, 313.50it/s]Loading training images:  52%|###################################################1                                               | 3102/6000 [00:09<00:09, 314.64it/s]Loading training images:  52%|###################################################7                                               | 3134/6000 [00:09<00:09, 303.18it/s]Loading training images:  53%|####################################################2                                              | 3168/6000 [00:09<00:09, 313.66it/s]Loading training images:  53%|####################################################8                                              | 3200/6000 [00:09<00:08, 313.80it/s]Loading training images:  54%|#####################################################4                                             | 3240/6000 [00:10<00:08, 323.63it/s]Loading training images:  55%|######################################################                                             | 3273/6000 [00:10<00:08, 325.44it/s]Loading training images:  55%|######################################################5                                            | 3306/6000 [00:10<00:08, 326.65it/s]Loading training images:  56%|#######################################################                                            | 3339/6000 [00:10<00:08, 326.24it/s]Loading training images:  56%|#######################################################7                                           | 3376/6000 [00:10<00:08, 324.94it/s]Loading training images:  57%|########################################################2                                          | 3409/6000 [00:10<00:07, 326.22it/s]Loading training images:  57%|########################################################7                                          | 3442/6000 [00:10<00:08, 313.26it/s]Loading training images:  58%|#########################################################3                                         | 3476/6000 [00:10<00:07, 319.47it/s]Loading training images:  58%|#########################################################8                                         | 3509/6000 [00:10<00:07, 319.14it/s]Loading training images:  59%|##########################################################5                                        | 3548/6000 [00:11<00:07, 328.34it/s]Loading training images:  60%|###########################################################                                        | 3581/6000 [00:11<00:07, 327.07it/s]Loading training images:  60%|###########################################################6                                       | 3614/6000 [00:11<00:07, 314.38it/s]Loading training images:  61%|############################################################1                                      | 3647/6000 [00:11<00:07, 318.19it/s]Loading training images:  61%|############################################################7                                      | 3679/6000 [00:11<00:07, 303.72it/s]Loading training images:  62%|#############################################################3                                     | 3717/6000 [00:11<00:07, 310.10it/s]Loading training images:  62%|#############################################################8                                     | 3749/6000 [00:11<00:07, 312.71it/s]Loading training images:  63%|##############################################################4                                    | 3784/6000 [00:11<00:06, 323.01it/s]Loading training images:  64%|##############################################################9                                    | 3817/6000 [00:11<00:06, 324.77it/s]Loading training images:  64%|###############################################################5                                   | 3850/6000 [00:12<00:06, 311.46it/s]Loading training images:  65%|################################################################1                                  | 3887/6000 [00:12<00:06, 314.42it/s]Loading training images:  65%|################################################################7                                  | 3925/6000 [00:12<00:06, 319.02it/s]Loading training images:  66%|#################################################################2                                 | 3957/6000 [00:12<00:06, 315.40it/s]Loading training images:  66%|#################################################################8                                 | 3989/6000 [00:12<00:06, 306.53it/s]Loading training images:  67%|##################################################################3                                | 4021/6000 [00:12<00:06, 307.15it/s]Loading training images:  68%|##################################################################8                                | 4054/6000 [00:12<00:06, 301.65it/s]Loading training images:  68%|###################################################################4                               | 4085/6000 [00:12<00:06, 302.29it/s]Loading training images:  69%|###################################################################9                               | 4118/6000 [00:12<00:06, 310.04it/s]Loading training images:  69%|####################################################################5                              | 4154/6000 [00:12<00:05, 311.80it/s]Loading training images:  70%|#####################################################################                              | 4186/6000 [00:13<00:05, 309.51it/s]Loading training images:  70%|#####################################################################6                             | 4221/6000 [00:13<00:05, 307.44it/s]Loading training images:  71%|######################################################################1                            | 4254/6000 [00:13<00:05, 313.74it/s]Loading training images:  72%|######################################################################8                            | 4292/6000 [00:13<00:05, 318.56it/s]Loading training images:  72%|#######################################################################4                           | 4331/6000 [00:13<00:05, 325.94it/s]Loading training images:  73%|########################################################################                           | 4364/6000 [00:13<00:05, 325.28it/s]Loading training images:  73%|########################################################################6                          | 4401/6000 [00:13<00:04, 325.03it/s]Loading training images:  74%|#########################################################################1                         | 4434/6000 [00:13<00:05, 307.31it/s]Loading training images:  74%|#########################################################################7                         | 4469/6000 [00:13<00:04, 309.37it/s]Loading training images:  75%|##########################################################################2                        | 4503/6000 [00:14<00:04, 316.91it/s]Loading training images:  76%|##########################################################################8                        | 4535/6000 [00:14<00:04, 316.95it/s]Loading training images:  76%|###########################################################################3                       | 4568/6000 [00:14<00:04, 315.99it/s]Loading training images:  77%|###########################################################################9                       | 4600/6000 [00:14<00:04, 317.13it/s]Loading training images:  77%|############################################################################4                      | 4632/6000 [00:14<00:04, 317.84it/s]Loading training images:  78%|############################################################################9                      | 4664/6000 [00:14<00:04, 318.41it/s]Loading training images:  78%|#############################################################################5                     | 4697/6000 [00:14<00:04, 321.04it/s]Loading training images:  79%|##############################################################################                     | 4732/6000 [00:14<00:04, 315.45it/s]Loading training images:  79%|##############################################################################6                    | 4769/6000 [00:14<00:03, 316.92it/s]Loading training images:  80%|###############################################################################2                   | 4804/6000 [00:15<00:03, 315.87it/s]Loading training images:  81%|###############################################################################7                   | 4836/6000 [00:15<00:03, 315.99it/s]Loading training images:  81%|################################################################################3                  | 4868/6000 [00:15<00:03, 299.29it/s]Loading training images:  82%|################################################################################8                  | 4899/6000 [00:15<00:03, 301.65it/s]Loading training images:  82%|#################################################################################4                 | 4934/6000 [00:15<00:03, 305.51it/s]Loading training images:  83%|#################################################################################9                 | 4966/6000 [00:15<00:03, 309.25it/s]Loading training images:  83%|##################################################################################5                | 5005/6000 [00:15<00:03, 318.22it/s]Loading training images:  84%|###################################################################################1               | 5037/6000 [00:15<00:03, 317.49it/s]Loading training images:  85%|###################################################################################6               | 5071/6000 [00:15<00:02, 316.85it/s]Loading training images:  85%|####################################################################################2              | 5106/6000 [00:16<00:02, 326.03it/s]Loading training images:  86%|####################################################################################7              | 5139/6000 [00:16<00:02, 327.16it/s]Loading training images:  86%|#####################################################################################3             | 5172/6000 [00:16<00:02, 327.86it/s]Loading training images:  87%|#####################################################################################8             | 5205/6000 [00:16<00:02, 319.98it/s]Loading training images:  87%|######################################################################################4            | 5238/6000 [00:16<00:02, 316.72it/s]Loading training images:  88%|######################################################################################9            | 5272/6000 [00:16<00:02, 309.56it/s]Loading training images:  88%|#######################################################################################5           | 5306/6000 [00:16<00:02, 310.71it/s]Loading training images:  89%|########################################################################################           | 5338/6000 [00:16<00:02, 312.59it/s]Loading training images:  90%|########################################################################################6          | 5370/6000 [00:16<00:02, 310.77it/s]Loading training images:  90%|#########################################################################################1         | 5402/6000 [00:16<00:01, 303.04it/s]Loading training images:  91%|#########################################################################################6         | 5433/6000 [00:17<00:01, 303.34it/s]Loading training images:  91%|##########################################################################################2        | 5469/6000 [00:17<00:01, 306.54it/s]Loading training images:  92%|##########################################################################################7        | 5502/6000 [00:17<00:01, 311.52it/s]Loading training images:  92%|###########################################################################################3       | 5534/6000 [00:17<00:01, 311.40it/s]Loading training images:  93%|###########################################################################################8       | 5568/6000 [00:17<00:01, 309.32it/s]Loading training images:  93%|############################################################################################4      | 5601/6000 [00:17<00:01, 314.75it/s]Loading training images:  94%|############################################################################################9      | 5633/6000 [00:17<00:01, 315.51it/s]Loading training images:  94%|#############################################################################################4     | 5666/6000 [00:17<00:01, 309.39it/s]Loading training images:  95%|##############################################################################################     | 5697/6000 [00:17<00:00, 309.49it/s]Loading training images:  95%|##############################################################################################5    | 5728/6000 [00:18<00:00, 309.53it/s]Loading training images:  96%|###############################################################################################    | 5759/6000 [00:18<00:00, 309.66it/s]Loading training images:  96%|###############################################################################################5   | 5790/6000 [00:18<00:00, 295.99it/s]Loading training images:  97%|################################################################################################   | 5820/6000 [00:18<00:00, 296.85it/s]Loading training images:  98%|################################################################################################5  | 5850/6000 [00:18<00:00, 280.89it/s]Loading training images:  98%|#################################################################################################  | 5879/6000 [00:18<00:00, 282.69it/s]Loading training images:  98%|#################################################################################################4 | 5908/6000 [00:18<00:00, 271.23it/s]Loading training images:  99%|################################################################################################## | 5942/6000 [00:18<00:00, 278.81it/s]Loading training images: 100%|##################################################################################################5| 5972/6000 [00:18<00:00, 281.77it/s]Loading training images: 100%|###################################################################################################| 6000/6000 [00:18<00:00, 316.13it/s]
Loading test images:   0%|                                                                                                                   | 0/1500 [00:00<?, ?it/s]Loading test images:   2%|##                                                                                                       | 29/1500 [00:00<00:05, 259.85it/s]Loading test images:   4%|###8                                                                                                     | 55/1500 [00:00<00:06, 236.68it/s]Loading test images:   6%|#####8                                                                                                   | 83/1500 [00:00<00:05, 242.05it/s]Loading test images:   8%|#######8                                                                                                | 113/1500 [00:00<00:05, 261.25it/s]Loading test images:   9%|#########7                                                                                              | 141/1500 [00:00<00:05, 262.98it/s]Loading test images:  12%|############3                                                                                           | 178/1500 [00:00<00:04, 286.28it/s]Loading test images:  14%|##############6                                                                                         | 211/1500 [00:00<00:04, 297.90it/s]Loading test images:  17%|#################2                                                                                      | 249/1500 [00:00<00:04, 309.21it/s]Loading test images:  19%|###################6                                                                                    | 284/1500 [00:00<00:03, 320.83it/s]Loading test images:  21%|#####################9                                                                                  | 317/1500 [00:01<00:03, 323.25it/s]Loading test images:  24%|########################4                                                                               | 353/1500 [00:01<00:03, 333.69it/s]Loading test images:  26%|##########################8                                                                             | 387/1500 [00:01<00:03, 329.81it/s]Loading test images:  28%|#############################1                                                                          | 421/1500 [00:01<00:03, 332.54it/s]Loading test images:  30%|###############################5                                                                        | 455/1500 [00:01<00:03, 334.67it/s]Loading test images:  33%|##################################1                                                                     | 493/1500 [00:01<00:03, 332.76it/s]Loading test images:  36%|####################################9                                                                   | 533/1500 [00:01<00:02, 336.99it/s]Loading test images:  38%|#######################################3                                                                | 568/1500 [00:01<00:02, 329.28it/s]Loading test images:  40%|##########################################                                                              | 606/1500 [00:01<00:02, 329.39it/s]Loading test images:  43%|############################################3                                                           | 640/1500 [00:02<00:02, 332.01it/s]Loading test images:  45%|##############################################7                                                         | 674/1500 [00:02<00:02, 332.80it/s]Loading test images:  47%|#################################################                                                       | 708/1500 [00:02<00:02, 327.26it/s]Loading test images:  49%|###################################################3                                                    | 741/1500 [00:02<00:02, 320.55it/s]Loading test images:  52%|#####################################################6                                                  | 774/1500 [00:02<00:02, 322.84it/s]Loading test images:  54%|#######################################################9                                                | 807/1500 [00:02<00:02, 310.05it/s]Loading test images:  56%|##########################################################1                                             | 839/1500 [00:02<00:02, 312.78it/s]Loading test images:  58%|############################################################5                                           | 873/1500 [00:02<00:02, 313.20it/s]Loading test images:  60%|##############################################################7                                         | 905/1500 [00:02<00:01, 314.89it/s]Loading test images:  63%|#################################################################                                       | 938/1500 [00:02<00:01, 319.15it/s]Loading test images:  65%|###################################################################2                                    | 970/1500 [00:03<00:01, 319.38it/s]Loading test images:  67%|####################################################################8                                  | 1002/1500 [00:03<00:01, 319.41it/s]Loading test images:  69%|#######################################################################                                | 1034/1500 [00:03<00:01, 319.27it/s]Loading test images:  71%|#########################################################################1                             | 1066/1500 [00:03<00:01, 310.53it/s]Loading test images:  74%|###########################################################################7                           | 1103/1500 [00:03<00:01, 319.63it/s]Loading test images:  76%|##############################################################################1                        | 1138/1500 [00:03<00:01, 316.29it/s]Loading test images:  78%|################################################################################6                      | 1174/1500 [00:03<00:01, 321.43it/s]Loading test images:  81%|##################################################################################9                    | 1208/1500 [00:03<00:00, 325.32it/s]Loading test images:  83%|#####################################################################################3                 | 1243/1500 [00:03<00:00, 332.31it/s]Loading test images:  85%|#######################################################################################6               | 1277/1500 [00:04<00:00, 325.40it/s]Loading test images:  87%|#########################################################################################9             | 1310/1500 [00:04<00:00, 321.17it/s]Loading test images:  90%|############################################################################################4          | 1347/1500 [00:04<00:00, 321.11it/s]Loading test images:  92%|##############################################################################################7        | 1380/1500 [00:04<00:00, 322.05it/s]Loading test images:  94%|#################################################################################################      | 1413/1500 [00:04<00:00, 320.49it/s]Loading test images:  97%|###################################################################################################6   | 1451/1500 [00:04<00:00, 326.16it/s]Loading test images:  99%|######################################################################################################1| 1487/1500 [00:04<00:00, 325.16it/s]Loading test images: 100%|#######################################################################################################| 1500/1500 [00:04<00:00, 316.40it/s]

=== FINALE STATISTIKEN ===
Training shape: (6000, 200, 200, 3)
Test shape: (1500, 200, 200, 3)
Klassengewichte: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0), 4: np.float64(1.0)}

--- Verwende 80/20 Split aus data/randomized_mushrooms/inaturalist ---
Training: 6000 Bilder
Test: 1500 Bilder

Building 5-class ResNet-inspired CNN model for mushroom classification (Keras 3.x EXKLUSIV)...
‚úÖ ResNet-inspiriertes Modell erfolgreich erstellt f√ºr 5 Klassen mit Keras 3.x Functional API
‚úÖ Verwendet: Residual Connections + GlobalAveragePooling2D + reduzierte Parameter

Training for max 30 epochs...
Epoch 1/30
188/188 - 113s - 600ms/step - accuracy: 0.4158 - loss: 2.8763 - val_accuracy: 0.2033 - val_loss: 2.7988 - learning_rate: 1.0000e-03
Epoch 2/30
188/188 - 105s - 557ms/step - accuracy: 0.6270 - loss: 1.7482 - val_accuracy: 0.3960 - val_loss: 2.1319 - learning_rate: 1.0000e-03
Epoch 3/30
188/188 - 105s - 556ms/step - accuracy: 0.6748 - loss: 1.2759 - val_accuracy: 0.3120 - val_loss: 2.7050 - learning_rate: 1.0000e-03
Epoch 4/30
188/188 - 106s - 562ms/step - accuracy: 0.7328 - loss: 0.9655 - val_accuracy: 0.4633 - val_loss: 1.5205 - learning_rate: 1.0000e-03
Epoch 5/30
188/188 - 104s - 553ms/step - accuracy: 0.7413 - loss: 0.8403 - val_accuracy: 0.5627 - val_loss: 1.3385 - learning_rate: 1.0000e-03
Epoch 6/30
188/188 - 104s - 555ms/step - accuracy: 0.7653 - loss: 0.7448 - val_accuracy: 0.5793 - val_loss: 1.1983 - learning_rate: 1.0000e-03
Epoch 7/30
188/188 - 105s - 556ms/step - accuracy: 0.7855 - loss: 0.6728 - val_accuracy: 0.6873 - val_loss: 0.8656 - learning_rate: 1.0000e-03
Epoch 8/30
188/188 - 105s - 556ms/step - accuracy: 0.7913 - loss: 0.6060 - val_accuracy: 0.5780 - val_loss: 1.4077 - learning_rate: 1.0000e-03
Epoch 9/30
188/188 - 104s - 553ms/step - accuracy: 0.8025 - loss: 0.5868 - val_accuracy: 0.4453 - val_loss: 1.4990 - learning_rate: 1.0000e-03
Epoch 10/30
188/188 - 105s - 560ms/step - accuracy: 0.8182 - loss: 0.5528 - val_accuracy: 0.7533 - val_loss: 0.7395 - learning_rate: 1.0000e-03
Epoch 11/30
188/188 - 105s - 557ms/step - accuracy: 0.8268 - loss: 0.5121 - val_accuracy: 0.5620 - val_loss: 1.2470 - learning_rate: 1.0000e-03
Epoch 12/30
188/188 - 105s - 560ms/step - accuracy: 0.8385 - loss: 0.4842 - val_accuracy: 0.7587 - val_loss: 0.6594 - learning_rate: 1.0000e-03
Epoch 13/30
188/188 - 105s - 559ms/step - accuracy: 0.8417 - loss: 0.4833 - val_accuracy: 0.7693 - val_loss: 0.6199 - learning_rate: 1.0000e-03
Epoch 14/30
188/188 - 105s - 560ms/step - accuracy: 0.8588 - loss: 0.4308 - val_accuracy: 0.7580 - val_loss: 0.7363 - learning_rate: 1.0000e-03
Epoch 15/30
188/188 - 106s - 562ms/step - accuracy: 0.8595 - loss: 0.4271 - val_accuracy: 0.6940 - val_loss: 0.9343 - learning_rate: 1.0000e-03
Epoch 16/30
188/188 - 106s - 565ms/step - accuracy: 0.8655 - loss: 0.4144 - val_accuracy: 0.6347 - val_loss: 1.0942 - learning_rate: 1.0000e-03
Epoch 17/30
188/188 - 106s - 561ms/step - accuracy: 0.8838 - loss: 0.3619 - val_accuracy: 0.7553 - val_loss: 0.8130 - learning_rate: 1.0000e-03
Epoch 18/30
188/188 - 106s - 563ms/step - accuracy: 0.8885 - loss: 0.3591 - val_accuracy: 0.7560 - val_loss: 0.7379 - learning_rate: 1.0000e-03
Epoch 19/30
188/188 - 106s - 565ms/step - accuracy: 0.9278 - loss: 0.2424 - val_accuracy: 0.7927 - val_loss: 0.6379 - learning_rate: 5.0000e-04
Epoch 20/30
188/188 - 106s - 565ms/step - accuracy: 0.9413 - loss: 0.1946 - val_accuracy: 0.8040 - val_loss: 0.5940 - learning_rate: 5.0000e-04
Epoch 21/30
188/188 - 106s - 566ms/step - accuracy: 0.9480 - loss: 0.1694 - val_accuracy: 0.7667 - val_loss: 0.7847 - learning_rate: 5.0000e-04
Epoch 22/30
188/188 - 106s - 561ms/step - accuracy: 0.9540 - loss: 0.1586 - val_accuracy: 0.7787 - val_loss: 0.7435 - learning_rate: 5.0000e-04
Epoch 23/30
188/188 - 105s - 561ms/step - accuracy: 0.9533 - loss: 0.1626 - val_accuracy: 0.6493 - val_loss: 1.4218 - learning_rate: 5.0000e-04
Epoch 24/30
188/188 - 106s - 561ms/step - accuracy: 0.9585 - loss: 0.1425 - val_accuracy: 0.7787 - val_loss: 0.7441 - learning_rate: 5.0000e-04
Epoch 25/30
188/188 - 106s - 561ms/step - accuracy: 0.9560 - loss: 0.1496 - val_accuracy: 0.8180 - val_loss: 0.6685 - learning_rate: 5.0000e-04
Epoch 26/30
188/188 - 106s - 564ms/step - accuracy: 0.9737 - loss: 0.0979 - val_accuracy: 0.8413 - val_loss: 0.5770 - learning_rate: 2.5000e-04
Epoch 27/30
188/188 - 107s - 567ms/step - accuracy: 0.9792 - loss: 0.0801 - val_accuracy: 0.8380 - val_loss: 0.6139 - learning_rate: 2.5000e-04
Epoch 28/30
188/188 - 106s - 565ms/step - accuracy: 0.9848 - loss: 0.0697 - val_accuracy: 0.8340 - val_loss: 0.6028 - learning_rate: 2.5000e-04
Epoch 29/30
188/188 - 106s - 564ms/step - accuracy: 0.9842 - loss: 0.0650 - val_accuracy: 0.8187 - val_loss: 0.6651 - learning_rate: 2.5000e-04
Epoch 30/30
188/188 - 106s - 565ms/step - accuracy: 0.9850 - loss: 0.0629 - val_accuracy: 0.8300 - val_loss: 0.6592 - learning_rate: 2.5000e-04

Evaluating model performance...
Final test accuracy: 0.8413

=== KLASSENWEISE PERFORMANCE ===
Phallus_impudicus: 0.9200 (300 samples)
Amanita_muscaria: 0.8800 (300 samples)
Boletus_edulis: 0.8200 (300 samples)
Cantharellus_cibarius: 0.8300 (300 samples)
Armillaria_mellea: 0.7567 (300 samples)

Confusion Matrix:
[[276   7  10   3   4]
 [  7 264  20   5   4]
 [ 31   5 246   2  16]
 [  7  10   6 249  28]
 [ 20  11  29  13 227]]

Classification Report:
                       precision    recall  f1-score   support

    Phallus_impudicus       0.81      0.92      0.86       300
     Amanita_muscaria       0.89      0.88      0.88       300
       Boletus_edulis       0.79      0.82      0.81       300
Cantharellus_cibarius       0.92      0.83      0.87       300
    Armillaria_mellea       0.81      0.76      0.78       300

             accuracy                           0.84      1500
            macro avg       0.84      0.84      0.84      1500
         weighted avg       0.84      0.84      0.84      1500

‚úÖ Modell gespeichert im Keras 3.x Format: models/mushroom_5class_resnet_cnn_80_20.keras
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
‚úÖ R√ºckw√§rtskompatible .h5 Version erstellt: models/mushroom_5class_resnet_cnn_80_20.h5

üéâ Training erfolgreich abgeschlossen mit Keras 3.x!
‚úÖ ResNet-inspiriertes 5-Klassen Modell mit 80/20 Split gespeichert im modernen .keras Format
