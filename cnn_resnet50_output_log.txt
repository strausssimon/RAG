
MUSHROOM CLASSIFICATION CNN - 5 CLASSES + RESIDUAL CONNECTIONS (TensorFlow 2.19.1 & Keras 3.x EXKLUSIV)
==========================================================================================
Classes: Amanita_muscaria, Boletus_edulis, Armillaria_mellea, Tylopilus_felleus, Suillellus_luridus, Amanita_phalloides, Imleria_badia
Architecture: ResNet-inspired with Residual Connections + GlobalAveragePooling2D
Improvements: Skip Connections, Reduced Parameters, Better Gradient Flow
Data: 80/20 split from data/randomized_mushrooms/inaturalist
Training: Randomized 200x200 images (80%)
Testing: Randomized 200x200 images (20%)
Output: Modern .keras format (with .h5 fallback for compatibility)
KERAS 3.x ERFORDERLICH - Keine Fallbacks!
==========================================================================================

Starting training process with 80/20 split from randomized data...

Lade randomisierte Pilzdaten für 80/20 Train/Test Split...
Lade Daten aus: C:\Users\strau\OneDrive - BildungsCentrum der Wirtschaft gemeinnützige Gesellschaft mbH\Git\sml_main\SmallLanguageModels\data\randomized_mushrooms\inaturalist
Konfigurierte Klassen: ['Phallus_impudicus', 'Amanita_muscaria', 'Boletus_edulis', 'Cantharellus_cibarius', 'Armillaria_mellea']
Anzahl Klassen: 5

1. Sammle alle Bilder aus allen Klassen...
   Phallus_impudicus: 1500 Dateien gefunden
   Amanita_muscaria: 1500 Dateien gefunden
   Boletus_edulis: 1500 Dateien gefunden
   Cantharellus_cibarius: 1500 Dateien gefunden
   Armillaria_mellea: 1500 Dateien gefunden

   Gesamt gesammelt: 7500 Dateien

2. Erstelle 80/20 Train/Test Split...
   Training: 6000 Dateien (80.0%)
   Test: 1500 Dateien (20.0%)

   Klassenverteilung im Training:
     Phallus_impudicus: 1200 Bilder
     Amanita_muscaria: 1200 Bilder
     Boletus_edulis: 1200 Bilder
     Cantharellus_cibarius: 1200 Bilder
     Armillaria_mellea: 1200 Bilder

   Klassenverteilung im Test:
     Phallus_impudicus: 300 Bilder
     Amanita_muscaria: 300 Bilder
     Boletus_edulis: 300 Bilder
     Cantharellus_cibarius: 300 Bilder
     Armillaria_mellea: 300 Bilder

3. Lade Bilddaten...

Loading training images: 100%|#########################################################################| 6000/6000 [00:17<00:00, 348.62it/s]

Loading test images: 100%|#############################################################################| 1500/1500 [00:04<00:00, 344.05it/s]

=== FINALE STATISTIKEN ===
Training shape: (6000, 200, 200, 3)
Test shape: (1500, 200, 200, 3)
Klassengewichte: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0), 4: np.float64(1.0)}

--- Verwende 80/20 Split aus data/randomized_mushrooms/inaturalist ---
Training: 6000 Bilder
Test: 1500 Bilder

Building 7-class ResNet-inspired CNN model for mushroom classification (Keras 3.x EXKLUSIV)...
ResNet-inspiriertes Modell erfolgreich erstellt für 5 Klassen mit Keras 3.x Functional API
Verwendet: Residual Connections + GlobalAveragePooling2D + reduzierte Parameter

Training for max 30 epochs...
Epoch 1/30
188/188 - 123s - 652ms/step - accuracy: 0.4753 - loss: 2.6861 - val_accuracy: 0.2027 - val_loss: 2.9527 - learning_rate: 1.0000e-03
Epoch 2/30
188/188 - 115s - 612ms/step - accuracy: 0.6475 - loss: 1.6584 - val_accuracy: 0.2820 - val_loss: 2.9886 - learning_rate: 1.0000e-03
Epoch 3/30
188/188 - 116s - 618ms/step - accuracy: 0.6848 - loss: 1.2281 - val_accuracy: 0.6667 - val_loss: 1.1618 - learning_rate: 1.0000e-03
Epoch 4/30
188/188 - 115s - 610ms/step - accuracy: 0.7188 - loss: 0.9600 - val_accuracy: 0.6847 - val_loss: 0.9590 - learning_rate: 1.0000e-03
Epoch 5/30
188/188 - 113s - 602ms/step - accuracy: 0.7403 - loss: 0.8194 - val_accuracy: 0.6960 - val_loss: 0.9076 - learning_rate: 1.0000e-03
Epoch 6/30
188/188 - 113s - 601ms/step - accuracy: 0.7653 - loss: 0.7199 - val_accuracy: 0.3807 - val_loss: 1.6964 - learning_rate: 1.0000e-03
Epoch 7/30
188/188 - 113s - 601ms/step - accuracy: 0.7703 - loss: 0.6720 - val_accuracy: 0.6480 - val_loss: 0.9795 - learning_rate: 1.0000e-03
Epoch 8/30
188/188 - 114s - 605ms/step - accuracy: 0.7823 - loss: 0.6452 - val_accuracy: 0.5667 - val_loss: 1.3928 - learning_rate: 1.0000e-03
Epoch 9/30
188/188 - 114s - 607ms/step - accuracy: 0.8000 - loss: 0.6010 - val_accuracy: 0.4713 - val_loss: 1.7163 - learning_rate: 1.0000e-03
Epoch 10/30
188/188 - 115s - 610ms/step - accuracy: 0.8142 - loss: 0.5597 - val_accuracy: 0.6933 - val_loss: 0.9591 - learning_rate: 1.0000e-03
Epoch 11/30
188/188 - 114s - 605ms/step - accuracy: 0.8477 - loss: 0.4548 - val_accuracy: 0.6607 - val_loss: 1.0350 - learning_rate: 5.0000e-04
Epoch 12/30
188/188 - 114s - 608ms/step - accuracy: 0.8707 - loss: 0.3931 - val_accuracy: 0.7960 - val_loss: 0.5959 - learning_rate: 5.0000e-04
Epoch 13/30
188/188 - 115s - 611ms/step - accuracy: 0.8702 - loss: 0.3954 - val_accuracy: 0.7487 - val_loss: 0.7260 - learning_rate: 5.0000e-04
Epoch 14/30
188/188 - 114s - 609ms/step - accuracy: 0.8817 - loss: 0.3538 - val_accuracy: 0.7527 - val_loss: 0.7856 - learning_rate: 5.0000e-04
Epoch 15/30
188/188 - 115s - 612ms/step - accuracy: 0.8852 - loss: 0.3364 - val_accuracy: 0.7120 - val_loss: 0.9275 - learning_rate: 5.0000e-04
Epoch 16/30
188/188 - 116s - 615ms/step - accuracy: 0.9000 - loss: 0.3117 - val_accuracy: 0.7880 - val_loss: 0.6471 - learning_rate: 5.0000e-04
Epoch 17/30
188/188 - 115s - 611ms/step - accuracy: 0.9133 - loss: 0.2702 - val_accuracy: 0.7880 - val_loss: 0.6540 - learning_rate: 5.0000e-04
Epoch 18/30
188/188 - 115s - 610ms/step - accuracy: 0.9387 - loss: 0.2064 - val_accuracy: 0.7940 - val_loss: 0.7158 - learning_rate: 2.5000e-04
Epoch 19/30
188/188 - 115s - 610ms/step - accuracy: 0.9433 - loss: 0.1880 - val_accuracy: 0.7840 - val_loss: 0.6987 - learning_rate: 2.5000e-04

Evaluating model performance...
Final test accuracy: 0.7960

=== KLASSENWEISE PERFORMANCE ===
Phallus_impudicus: 0.7767 (300 samples)
Amanita_muscaria: 0.8600 (300 samples)
Boletus_edulis: 0.8267 (300 samples)
Cantharellus_cibarius: 0.7300 (300 samples)
Armillaria_mellea: 0.7867 (300 samples)

Confusion Matrix:
[[233  10  33   2  22]
 [  2 258  20   7  13]
 [ 16   8 248   1  27]
 [  1  13   2 219  65]
 [  6   8  42   8 236]]

Classification Report:
                       precision    recall  f1-score   support

    Phallus_impudicus       0.90      0.78      0.84       300
     Amanita_muscaria       0.87      0.86      0.86       300
       Boletus_edulis       0.72      0.83      0.77       300
Cantharellus_cibarius       0.92      0.73      0.82       300
    Armillaria_mellea       0.65      0.79      0.71       300

             accuracy                           0.80      1500
            macro avg       0.81      0.80      0.80      1500
         weighted avg       0.81      0.80      0.80      1500

Modell gespeichert im Keras 3.x Format: models/mushroom_7class_resnet_cnn_80_20_split.keras
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
Rückwärtskompatible .h5 Version erstellt: models/mushroom_7class_resnet_cnn_80_20_split.h5

Training erfolgreich abgeschlossen mit Keras 3.x!
ResNet-inspiriertes 7-Klassen Modell mit 80/20 Split gespeichert im modernen .keras Format